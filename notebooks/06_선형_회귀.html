
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>6장 선형 회귀 &#8212; 데이터과학의 첫걸음</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/06_선형_회귀';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="7장 로지스틱 회귀를 이용한 분류" href="07_%EB%A1%9C%EC%A7%80%EC%8A%A4%ED%8B%B1_%ED%9A%8C%EA%B7%80%EB%A5%BC_%EC%9D%B4%EC%9A%A9%ED%95%9C_%EB%B6%84%EB%A5%98.html" />
    <link rel="prev" title="5장 통계적 학습" href="05_%ED%86%B5%EA%B3%84%EC%A0%81_%ED%95%99%EC%8A%B5.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="00_%EC%84%9C%EB%AC%B8.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="데이터과학의 첫걸음 - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="데이터과학의 첫걸음 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="00_%EC%84%9C%EB%AC%B8.html">
                    데이터과학의 첫걸음: 시작하며
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_%ED%8C%8C%EC%9D%B4%EC%8D%AC_%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0.html">1장 파이썬 시작하기</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_%ED%8C%8C%EC%9D%B4%EC%8D%AC_%EC%BD%94%EB%94%A9_%EA%B8%B0%EC%B4%88.html">2장 파이썬 코딩 기초</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_%EC%9D%80%ED%96%89_%ED%85%94%EB%A0%88%EB%A7%88%EC%BC%80%ED%8C%85_%EB%8D%B0%EC%9D%B4%ED%84%B0_%EB%B6%84%EC%84%9D.html">3장 은행 텔레마케팅 데이터 분석</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_%EC%A0%84%EC%9E%90%EC%83%81%EA%B1%B0%EB%9E%98_%EB%8D%B0%EC%9D%B4%ED%84%B0_%EB%B6%84%EC%84%9D.html">4장 전자상거래 데이터 분석</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_%ED%86%B5%EA%B3%84%EC%A0%81_%ED%95%99%EC%8A%B5.html">5장 통계적 학습</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">6장 선형 회귀</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_%EB%A1%9C%EC%A7%80%EC%8A%A4%ED%8B%B1_%ED%9A%8C%EA%B7%80%EB%A5%BC_%EC%9D%B4%EC%9A%A9%ED%95%9C_%EB%B6%84%EB%A5%98.html">7장 로지스틱 회귀를 이용한 분류</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_KNN%EC%9D%84_%EC%9D%B4%EC%9A%A9%ED%95%9C_%EB%B6%84%EB%A5%98.html">8장 KNN 분류</a></li>
<li class="toctree-l1"><a class="reference internal" href="09_%EB%82%98%EC%9D%B4%EB%B8%8C_%EB%B2%A0%EC%9D%B4%EC%A6%88_%EB%B6%84%EB%A5%98.html">9장 나이브 베이즈 분류</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_%EB%B3%80%EC%88%98%EC%84%A0%ED%83%9D_%EB%B0%8F_%EC%A0%95%EA%B7%9C%ED%99%94.html">10장 변수선택 및 정규화</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_%EC%B6%94%EC%B2%9C_%EC%8B%9C%EC%8A%A4%ED%85%9C.html">11장 추천 시스템</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_%EA%B2%B0%EC%A0%95_%ED%8A%B8%EB%A6%AC_%EB%A7%8C%EB%93%A4%EA%B8%B0.html">12장 결정 트리 만들기</a></li>
<li class="toctree-l1"><a class="reference internal" href="13_%ED%8A%B8%EB%A6%AC_%EA%B8%B0%EB%B0%98_%EB%AA%A8%ED%98%95.html">13장 트리 기반 모형</a></li>
<li class="toctree-l1"><a class="reference internal" href="14_%EC%84%9C%ED%8F%AC%ED%8A%B8_%EB%B2%A1%ED%84%B0_%EB%A8%B8%EC%8B%A0.html">14장 서포트 벡터 머신</a></li>
<li class="toctree-l1"><a class="reference internal" href="15_%EB%94%A5%EB%9F%AC%EB%8B%9D_%EC%9E%85%EB%AC%B8.html">15장 딥러닝 입문</a></li>
<li class="toctree-l1"><a class="reference internal" href="16_%EB%B9%84%EC%A7%80%EB%8F%84%ED%95%99%EC%8A%B5%EA%B3%BC_%EC%A3%BC%EC%84%B1%EB%B6%84_%EB%B6%84%EC%84%9D.html">16장 비지도학습과 주성분 분석</a></li>
<li class="toctree-l1"><a class="reference internal" href="17_%EC%83%9D%EC%A1%B4%EB%B6%84%EC%84%9D.html">17장 생존분석</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/pilsunchoi/book1" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/pilsunchoi/book1/issues/new?title=Issue%20on%20page%20%2Fnotebooks/06_선형_회귀.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/06_선형_회귀.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>6장 선형 회귀</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">6.1 단순 선형 회귀</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ols">OLS 추정</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">추정 예: 광고 데이터</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">산점도 및 추정 회귀선</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">OLS 추정</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chatgpt-q-a">ChatGPT Q&amp;A</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">시뮬레이션: 추정 오차</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">표준오차</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">신뢰구간</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">가설검정</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t">t-통계량</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#p">p값</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">통계적 유의성</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">추정 결과 해석</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">모델의 정확성 평가</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">6.2 다중 선형 회귀</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">추정</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#f">F-통계량</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">모델 적합성</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">예측: 신뢰구간</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">6.3 회귀 모델 기타 고려 사항</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">정성적 예측변수</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">상호작용 항의 도입</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">다항식 회귀</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">6.4 선형 회귀 예제</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">보스턴 주택가격 데이터</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#level-vs-log">Level 변수 vs Log 변수 계수의 해석</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">카시트 판매 데이터</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">자동차 연비 데이터</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">ChatGPT Q&amp;A</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">부록: 선형 회귀 로그변수 계수 해석</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">로그변화율</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">로그변수와 한계효과</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id29">로그변수 해석 사례</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>6장 선형 회귀<a class="headerlink" href="#id1" title="Link to this heading">#</a></h1>
<p>자료 출처: <a class="reference external" href="https://www.statlearning.com/">ISLP (An Introduction to Statistical Learning with Applications in Python)</a></p>
<p>이 장은 매우 간단한 지도학습(supervised learning) 접근인 <strong>선형 회귀</strong>(linear regression)에 대해 설명한다. 선형 회귀는 정량적(quantitative) 반응을 예측하는 데 특히 유용한 도구이다. 이것은 역사가 오래되었고 많은 전통적 통계학 교과서에서 중점적으로 다루는 주제이다. 이 책의 뒷부분에서 설명하는 일부 최신 통계적 학습 접근에 비해 다소 고리타분해 보일 수 있지만, 선형 회귀는 여전히 유용하고 널리 사용되는 통계적 학습 방법이다. 게다가 이것은 새로운 접근 방식을 위한 출발점이자 주춧돌 역할을 한다. 이후 장에서 다루는 많은 멋진 통계적 학습 기법은 선형 회귀의 일반화 또는 확장으로 볼 수 있다. 따라서 더 복잡한 학습 방법을 살펴보기 전에 선형 회귀를 잘 이해하는 것의 중요성은 아무리 강조해도 지나치지 않다.</p>
<section id="id2">
<h2>6.1 단순 선형 회귀<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p><strong>단순 선형 회귀</strong>(simple linear regression)는 정량적 반응변수 <span class="math notranslate nohighlight">\(Y\)</span>를 <strong>하나의 설명변수</strong> <span class="math notranslate nohighlight">\(X\)</span>로 예측하는 모형이다.</p>
<div class="math notranslate nohighlight">
\[
Y = \beta_0 + \beta_1 X + \epsilon
\]</div>
<p>여기에서 <span class="math notranslate nohighlight">\(\beta_0\)</span>와 <span class="math notranslate nohighlight">\(\beta_1\)</span>은 각각 절편과 기울기로서 <strong>계수</strong>(coefficient) 또는 <strong>파라미터</strong>(parameter) 라고 부르며, <span class="math notranslate nohighlight">\(\epsilon\)</span>은 <strong>오차항</strong>(error term)이다.</p>
<p>훈련 데이터를 사용하여 추정값 <span class="math notranslate nohighlight">\(\hat \beta_0\)</span>와 <span class="math notranslate nohighlight">\(\hat \beta_1\)</span>을 구하면, 특정 <span class="math notranslate nohighlight">\(x\)</span>에 대해 반응변수의 예측값 <span class="math notranslate nohighlight">\(\hat y\)</span>을 다음과 같이 구할 수 있다.</p>
<div class="math notranslate nohighlight">
\[
\hat y = \hat \beta_0 + \hat \beta_1 x
\]</div>
<section id="ols">
<h3>OLS 추정<a class="headerlink" href="#ols" title="Link to this heading">#</a></h3>
<p><span class="math notranslate nohighlight">\(n\)</span>개의 훈련 데이터 <span class="math notranslate nohighlight">\({(x_1, y_1), (x_2, y_2),..., (x_n, y_n)}\)</span>이 있다. 단순 선형 회귀로 <span class="math notranslate nohighlight">\(\hat \beta_0\)</span>와 <span class="math notranslate nohighlight">\(\hat \beta_1\)</span>을 추정하고자 한다. <span class="math notranslate nohighlight">\(X\)</span>의 <span class="math notranslate nohighlight">\(i\)</span>번째 값에 대한 <span class="math notranslate nohighlight">\(Y\)</span>의 예측값을 <span class="math notranslate nohighlight">\(\hat y_i = \hat \beta_0 + \hat \beta_1 x_i\)</span>이라 하자. 이때 <span class="math notranslate nohighlight">\(i\)</span>번째 반응의 실제 관측값 <span class="math notranslate nohighlight">\(y_i\)</span>와 예측값 <span class="math notranslate nohighlight">\(\hat y_i\)</span>의 차이인 <span class="math notranslate nohighlight">\(\hat e_i=y_i-\hat y_i\)</span>을 <strong>잔차</strong>(residual)라 부른다.</p>
<p>선형 회귀 모형을 추정하는 대표적인 방법은 다음의 <strong>잔차제곱합</strong>(RSS: residual sum of squares)을 최소화하는 <span class="math notranslate nohighlight">\(\hat \beta_0\)</span>와 <span class="math notranslate nohighlight">\(\hat \beta_1\)</span>을 구하는 방식이다.</p>
<div class="math notranslate nohighlight">
\[
{\rm RSS} = \hat e_1^2 + \hat e_2^2 +\cdots+ \hat e_n^2
\]</div>
<p>이를 <strong>통상최소제곱</strong>(OLS: ordinary least squares) 방식이라 한다.</p>
</section>
<section id="id3">
<h3>추정 예: 광고 데이터<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>ISLP에서 제공하는 <code class="docutils literal notranslate"><span class="pre">Advertising.csv</span></code> 데이터를 불러들인다. 데이터는 어떤 제품의 판매량과 광고비 지출에 관한 것이다. 200개의 서로 다른 시장에 대해 각각의 판매량과 광고액을 기록한 것이다. <code class="docutils literal notranslate"><span class="pre">pandas(pd)</span></code> 라이브러리를 불러들인 다음, <code class="docutils literal notranslate"><span class="pre">pd.read_csv()</span></code> 함수를 사용하여 데이터를 로딩한다.(데이터 파일이 들어있는 디렉토리를 적는 방법에 대해서는 2.2.1절의 ISLP “College.csv”를 불러들이는 방법을 참조할 것)</p>
<p>여기서 <code class="docutils literal notranslate"><span class="pre">Sales</span></code>는 판매량(단위: 1,000개)이며, <code class="docutils literal notranslate"><span class="pre">TV</span></code>, <code class="docutils literal notranslate"><span class="pre">Radio</span></code>, <code class="docutils literal notranslate"><span class="pre">Newspaper</span></code>는 광고액(단위: 1,000달러)으로서 각각 TV, 라디오, 신문에 대한 것이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">advertising</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../Data/Advertising.csv&#39;</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">advertising</span> <span class="o">=</span> <span class="n">advertising</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;radio&#39;</span><span class="p">:</span><span class="s1">&#39;Radio&#39;</span><span class="p">,</span><span class="s1">&#39;newspaper&#39;</span><span class="p">:</span><span class="s1">&#39;Newspaper&#39;</span><span class="p">,</span><span class="s1">&#39;sales&#39;</span><span class="p">:</span><span class="s1">&#39;Sales&#39;</span><span class="p">})</span>
<span class="n">advertising</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TV</th>
      <th>Radio</th>
      <th>Newspaper</th>
      <th>Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>230.1</td>
      <td>37.8</td>
      <td>69.2</td>
      <td>22.1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>44.5</td>
      <td>39.3</td>
      <td>45.1</td>
      <td>10.4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>17.2</td>
      <td>45.9</td>
      <td>69.3</td>
      <td>9.3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>151.5</td>
      <td>41.3</td>
      <td>58.5</td>
      <td>18.5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>180.8</td>
      <td>10.8</td>
      <td>58.4</td>
      <td>12.9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="id4">
<h3>산점도 및 추정 회귀선<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">seaborn</span></code> 라이브러리의 <code class="docutils literal notranslate"><span class="pre">regplot()</span></code>을 이용하여 판매량과 TV 광고지출의 선형 회귀 추정선을 산점도 상에 그린다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># 그림 크기를 전체적으로(globally) 설정</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">})</span> <span class="c1"># 그림 폰트를 전체적으로(globally) 설정</span>

<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;TV&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Sales&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">advertising</span><span class="p">,</span> 
            <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span><span class="s1">&#39;grey&#39;</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6ef4e43b2bca2a8aab0ee342c69699afec39b8b1d37d828a9b95e761f7d706ba.png" src="../_images/6ef4e43b2bca2a8aab0ee342c69699afec39b8b1d37d828a9b95e761f7d706ba.png" />
</div>
</div>
<p>위 그림에서 빨간색의 동그라미 점들이 200개 관측이다. 단순 선형 회귀는 이 산점도 상에서 <code class="docutils literal notranslate"><span class="pre">Sales</span></code>(매출)와 <code class="docutils literal notranslate"><span class="pre">TV</span></code>(광고지출)의 관계를 가장 잘 대표하는 직선을 찾는 것이다. 앞에서 설명한 대로 OLS는 RSS를 최소화하는 직선을 선택하는 방식이다. 즉 그림의 각 점에서 회귀선까지의 거리가 잔차인데, 이것들의 제곱합을 최소화한다는 것이다. 위 그림에서 점들을 통과하는 파란색 직선이 OLS로 구한 회귀선이다.</p>
</section>
<section id="id5">
<h3>OLS 추정<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<p>아래는 <code class="docutils literal notranslate"><span class="pre">statsmodels.formula.api</span></code>로 추정한 OLS 회귀 결과이다. 반응변수는 <code class="docutils literal notranslate"><span class="pre">Sales</span></code>, 예측변수는 <code class="docutils literal notranslate"><span class="pre">TV</span></code>이다. 기본 구문은 <code class="docutils literal notranslate"><span class="pre">smf.ols('y</span> <span class="pre">~</span> <span class="pre">x',</span> <span class="pre">data)</span></code>이며, 여기서 <code class="docutils literal notranslate"><span class="pre">y</span></code>는 반응변수, <code class="docutils literal notranslate"><span class="pre">x</span></code>는 예측변수, <code class="docutils literal notranslate"><span class="pre">data</span></code>는 두 변수가 들어있는 데이터프레임이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;Sales ~ TV&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">advertising</span><span class="p">)</span>
<span class="n">olsfit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">olsfit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                  Sales   R-squared:                       0.612
Model:                            OLS   Adj. R-squared:                  0.610
Method:                 Least Squares   F-statistic:                     312.1
Date:                Fri, 17 Oct 2025   Prob (F-statistic):           1.47e-42
Time:                        23:57:36   Log-Likelihood:                -519.05
No. Observations:                 200   AIC:                             1042.
Df Residuals:                     198   BIC:                             1049.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      7.0326      0.458     15.360      0.000       6.130       7.935
TV             0.0475      0.003     17.668      0.000       0.042       0.053
==============================================================================
Omnibus:                        0.531   Durbin-Watson:                   1.935
Prob(Omnibus):                  0.767   Jarque-Bera (JB):                0.669
Skew:                          -0.089   Prob(JB):                        0.716
Kurtosis:                       2.779   Cond. No.                         338.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
</section>
<section id="chatgpt-q-a">
<h3>ChatGPT Q&amp;A<a class="headerlink" href="#chatgpt-q-a" title="Link to this heading">#</a></h3>
<blockquote>
<div><p><strong>다음 코드를 설명해줘.</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>model = smf.ols(&#39;Sales ~ TV&#39;, data=advertising)  
olsfit = model.fit()  
print(olsfit.summary())**
</pre></div>
</div>
</div></blockquote>
<hr class="docutils" />
<blockquote>
<div><p>이 코드는 Python의 통계 모델링 라이브러리 중 하나인 <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>를 사용하여, 광고 데이터 세트(<code class="docutils literal notranslate"><span class="pre">advertising</span></code>) 내에서 TV 광고 지출(<code class="docutils literal notranslate"><span class="pre">TV</span></code>)과 판매량(<code class="docutils literal notranslate"><span class="pre">Sales</span></code>) 사이의 선형 관계를 분석하는 선형 회귀 모델을 구축하고 요약 결과를 출력합니다.</p>
<ol class="arabic simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">model</span> <span class="pre">=</span> <span class="pre">smf.ols('Sales</span> <span class="pre">~</span> <span class="pre">TV',</span> <span class="pre">data=advertising)</span></code></strong>: 이 줄은 <code class="docutils literal notranslate"><span class="pre">Sales</span></code>를 종속 변수로, <code class="docutils literal notranslate"><span class="pre">TV</span></code>를 독립 변수로 하는 선형 회귀 모델을 정의합니다. <code class="docutils literal notranslate"><span class="pre">~</span></code> 기호는 ‘Sales는 TV에 의해 예측된다’는 의미로, <code class="docutils literal notranslate"><span class="pre">ols</span></code> 함수는 최소 제곱법(Ordinary Least Squares, OLS)을 사용하여 파라미터를 추정합니다. <code class="docutils literal notranslate"><span class="pre">data=advertising</span></code>는 모델이 사용할 데이터 프레임을 지정합니다.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">olsfit</span> <span class="pre">=</span> <span class="pre">model.fit()</span></code></strong>: 이 줄은 앞서 정의한 선형 회귀 모델을 실제 데이터에 적합시키기 위해 <code class="docutils literal notranslate"><span class="pre">fit</span></code> 메서드를 호출합니다. 이 과정에서 모델의 파라미터(계수와 절편)가 데이터에 최적화되어 추정됩니다.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">print(olsfit.summary())</span></code></strong>: 이 줄은 적합된 모델의 요약 정보를 출력합니다. 이 요약 정보에는 다음과 같은 중요한 통계가 포함될 수 있습니다:</p>
<ul class="simple">
<li><p>모델의 계수(Coefficients), 즉 TV 광고 지출의 변화가 판매량에 어떤 영향을 미치는지 나타내는 값.</p></li>
<li><p>각 계수의 표준 오차(Std. Error), t 값(t-statistic), 그리고 p 값(p-value), 이는 계수의 통계적 유의성을 평가하는 데 사용됩니다.</p></li>
<li><p>결정계수(R-squared), 이는 모델이 데이터의 변동성을 얼마나 잘 설명하는지 나타내는 지표입니다.</p></li>
<li><p>F-통계량(F-statistic)과 그에 대한 p 값, 이는 모델 전체가 통계적으로 유의한지 평가합니다.</p></li>
</ul>
</li>
</ol>
<p>이 모델은 광고 분야에서 매우 중요한 질문인 “TV 광고 지출이 판매량에 어떤 영향을 미치는가?”에 대한 통찰을 제공할 수 있습니다.</p>
</div></blockquote>
<p><strong>추정 결과</strong></p>
<p>위 추정 결과를 보면, <span class="math notranslate nohighlight">\(\hat \beta_0=7.03\)</span>, <span class="math notranslate nohighlight">\(\hat \beta_1=0.0475\)</span>이다. <span class="math notranslate nohighlight">\(\hat \beta_1\)</span>의 의미는 TV 광고에 1단위(즉, <span class="math notranslate nohighlight">\(1,000\)</span> 달러)를 더 지출하면, 제품 판매량이 평균적으로 <span class="math notranslate nohighlight">\(0.0475\)</span> 단위(즉, <span class="math notranslate nohighlight">\(0.0475 \times 1,000=47.5\)</span>개) 늘어난다는 것이다</p>
<p>추정 결과를 표로 만들 때, 아래와 같이 <code class="docutils literal notranslate"><span class="pre">tables[1]</span></code> 메서드를 사용하면, 추정 계수 부분만 나오게 할 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">est</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;Sales ~ TV&#39;</span><span class="p">,</span> <span class="n">advertising</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">est</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      7.0326      0.458     15.360      0.000       6.130       7.935
TV             0.0475      0.003     17.668      0.000       0.042       0.053
==============================================================================
</pre></div>
</div>
</div>
</div>
</section>
<section id="id6">
<h3>시뮬레이션: 추정 오차<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>아래 그림 6.1의 왼쪽 패널에서 빨간색 직선은 <span class="math notranslate nohighlight">\(Y=2+3X\)</span>를 나타낸다. 이를 모집단 회귀선(population regression line)으로 삼아 다음과 같은 방식으로 시뮬레이션 데이터를 발생시키려고 한다.(여기서 <span class="math notranslate nohighlight">\(\epsilon\)</span>은 평균이 0인 정규분포를 따른다.)</p>
<div class="math notranslate nohighlight">
\[
Y=2+3X+\epsilon
\]</div>
<p>아래 그림의 왼쪽 패널에 있는 작은 동그라미들은 위 식에 의해 생성된 100개의 관측이다. 이 관측을 사용하여 단순 선형 회귀로 OLS 추정을 한 것이 파란색 직선이다. 이 최소제곱 선(least squares line)은 크기가 100인 표본을 기반으로 한 것이기 때문에 모집단 회귀선을 정확히 추정할 수는 없고 오차가 생기는 것은 당연하다.</p>
<p>아래 그림의 오른쪽 패널은 동일한 방식으로 시뮬레이션을 10번 실행한 결과이다. 10개의 추정 회귀선(하늘색)들이 빨간색의 실제 회귀선을 중심으로 기울기와 절편을 약간씩 달리하면서 그려져 있는 것을 알 수 있다. 각각의 최소제곱 선은 다르지만 평균적으로는 최소제곱 선이 모집단 회귀선에 매우 가깝다는 것을 알 수 있다.</p>
<p><strong>그림 6.1.</strong> 시뮬레이션 데이터세트. 왼쪽: 빨간색 선은 실제 관계인 <span class="math notranslate nohighlight">\(f(X) = 2+3X\)</span>로서 모집단 회귀선이라고 한다. 파란색 선은 최소제곱 선으로서 검정색 동그라미로 표시된 관측 데이터를 기반으로 <span class="math notranslate nohighlight">\(f(X)\)</span>를 OLS로 추정한 것이다. 오른쪽: 여기에서도 모집단 회귀선은 빨간색, 최소제곱은 짙은 파란색으로 표시돼 있다. 여기에서 하늘색 선은 10개의 최소제곱 선을 표시한 것으로, 각각은 별도의 무작위 관측 세트를 기반으로 계산한 것이다.</p>
<p><img alt="시뮬레이션 데이터세트" src="https://raw.githubusercontent.com/pilsunchoi/images/main/6-1.png" /></p>
<ul class="simple">
<li><p>그림 출처: ISLP, FIGURE 3.3</p></li>
</ul>
</section>
<section id="id7">
<h3>표준오차<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<p>추정 계수 <span class="math notranslate nohighlight">\(\hat \beta_0\)</span>와 <span class="math notranslate nohighlight">\(\hat \beta_1\)</span>이 실제 <span class="math notranslate nohighlight">\(\beta_0\)</span>와 <span class="math notranslate nohighlight">\(\beta_1\)</span>과 똑같을 수는 없고 <strong>오차</strong>(error)가 생길 수밖에 없다. 그 이유는 관측이 모집단이 아니라 표본이기 때문이다. <strong>표준오차</strong>(standard error)는 (그 의미를 대략적으로 말하면) <strong>오차가 평균적으로 어느 정도 되는지를 추정한 것</strong>이다.</p>
<p>우리 예에서는 TV 계수의 표준오차는 0.0027이다. 이 의미는 <span class="math notranslate nohighlight">\(\hat \beta_1=0.0475\)</span>으로 추정되었는데, <span class="math notranslate nohighlight">\(\beta_1\)</span> 참값과의 거리가 평균적으로 <span class="math notranslate nohighlight">\(0.0027\)</span>로 추정되었다는 것이다.</p>
</section>
<section id="id8">
<h3>신뢰구간<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<p>추정 계수의 표준오차를 알면 계수 참값에 대한 <strong>신뢰구간</strong>(confidence interval)을 계산할 수 있다. 가령 <span class="math notranslate nohighlight">\(\beta_1\)</span>에 대한 95% 신뢰구간은 대략 다음과 같다.(여기서 <span class="math notranslate nohighlight">\({\rm SE}(\hat \beta_1)\)</span>은 <span class="math notranslate nohighlight">\(\hat \beta_1\)</span>의 표준오차를 의미한다.)</p>
<div class="math notranslate nohighlight">
\[
\hat \beta_1 \pm 2 \cdot {\rm SE}(\hat \beta_1)
\]</div>
<p>95% 신뢰구간은 (그 의미를 대략적으로 말하면) <strong>해당 구간이 <span class="math notranslate nohighlight">\(\beta_1\)</span> 참값을 포함하고 있을 가능성이 95%라는 것이다. 표준오차가 작을수록 신뢰구간이 좁아지기 때문에 표준오차는 추정의 정확도</strong>를 의미한다고 할 수 있다. 즉 표준오차가 작을(클)수록 해당 추정 계수의 정확도가 높(낮)은 것이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">est</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;Sales ~ TV&#39;</span><span class="p">,</span> <span class="n">advertising</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">est</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      7.0326      0.458     15.360      0.000       6.130       7.935
TV             0.0475      0.003     17.668      0.000       0.042       0.053
==============================================================================
</pre></div>
</div>
</div>
</div>
</section>
<section id="id9">
<h3>가설검정<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<p>추정 계수의 표준오차를 알면 계수 참값에 대한 <strong>가설검정</strong>(hypothesis test)이 가능하다. 계수에 대한 대표적인 가설검정은 다음의 <strong>귀무가설</strong>(null hypothesis)에 대해</p>
<div class="math notranslate nohighlight">
\[
H_0: \beta_1=0
\]</div>
<p>다음의 <strong>대립가설</strong>(alternative hypothesis)을 검정하는 것이다.</p>
<div class="math notranslate nohighlight">
\[
H_1: \beta_1 \neq 0
\]</div>
</section>
<section id="t">
<h3>t-통계량<a class="headerlink" href="#t" title="Link to this heading">#</a></h3>
<p>귀무가설을 검정하려면 <span class="math notranslate nohighlight">\(\beta_1\)</span>이 0이 아니라고 확신할 만큼 추정값 <span class="math notranslate nohighlight">\(\hat \beta_1\)</span>이 0에서 충분히 떨어져 있는지를 따져 봐야 한다. 이를 가늠하는 척도가 <strong><span class="math notranslate nohighlight">\(t\)</span>-통계량</strong>(<span class="math notranslate nohighlight">\(t\)</span>-statistic)이다.</p>
<div class="math notranslate nohighlight">
\[
t=\frac {\hat \beta_1-0}{{\rm SE}(\hat \beta_1)}
\]</div>
<p>그런데 여기에서 <span class="math notranslate nohighlight">\(\hat \beta_1\)</span>이 <span class="math notranslate nohighlight">\(0\)</span>과 떨어져 있는 정도를 <span class="math notranslate nohighlight">\((\hat \beta_1-0)\)</span>으로 측정하는 것이 아니라 이것을 <span class="math notranslate nohighlight">\({\rm SE}(\hat \beta_1)\)</span>으로 나누는 이유는 무엇일까? 가령 자신의 기말고사 점수가 85점이고 학급 평균이 80점이라 할 때 자신의 점수가 평균보다 얼마만큼 잘한 것인지는 85점과 80점의 차이인 5점만으로는 알 수 없고 다른 학생들이 얼마나 잘했는지, 즉 성적의 분포를 알아야 한다. 평균이 80점일 때, 표준편차가 가령 10점이라면 85점은 그리 우수한 성적은 아니다. 평균보다 그리 높지 않다는 것이다. 반면 표준편차가 가령 2점이라면 85점은 거의 최고 점수로 봐도 무방하다. 즉 평균보다 한참 높은 점수이다.</p>
<p>따라서 동일한 5점 차이라고 해도 그 자체만으로는 차이의 크기가 어느 정도인지 가늠할 수 없고, 그것이 표준편차의 몇 배에 해당하는지를 알아야 차이의 크기가 어느 정도인지 파악할 수 있다. 위 식의 <span class="math notranslate nohighlight">\(t\)</span>-통계량이 바로 그것을 나타내는 지표이다.</p>
</section>
<section id="p">
<h3>p값<a class="headerlink" href="#p" title="Link to this heading">#</a></h3>
<p><span class="math notranslate nohighlight">\(t\)</span>-통계량이 주어졌을 때, 그것이 전체 분포에서 어느 정도 위치에 있는지를 파악해야만 가설검정을 수행할 수 있다. 앞의 시험성적 예에서 평균과 표준편차가 주어졌을 때 자신의 점수가 대략 상위 몇 퍼센트 수준인지 알아야만 시험을 잘 본 것인지 못 본 것인지 판단할 수 있는 것과 마찬가지다.</p>
<p>우리는 <span class="math notranslate nohighlight">\(t\)</span>-통계량의 절대값이 아주 커야만 <span class="math notranslate nohighlight">\(\beta_1\)</span>이 0이라는 귀무가설을 기각할 수 있다. <strong>유의수준이 5%이면, <span class="math notranslate nohighlight">\(t\)</span>-통계량의 절대값이 대략 2보다 클 경우 귀무가설을 기각한다.</strong> 이때 <strong>귀무가설을 잘못 기각</strong>하게 될 수도 있는데, 그 확률을 <strong><span class="math notranslate nohighlight">\(p\)</span>값</strong>이라고 한다. 즉 <span class="math notranslate nohighlight">\(p\)</span>값은 <span class="math notranslate nohighlight">\(\beta_1\)</span>이 실제로 0인데도, 주어진 <span class="math notranslate nohighlight">\(t\)</span>-통계량(절대값)과 같은 값이 나올 확률이다.</p>
</section>
<section id="id10">
<h3>통계적 유의성<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<p><strong>유의수준</strong>(significance level)은 귀무가설 기각 여부를 판단할 때 기준이 되는 것으로서 <strong>귀무가설을 잘못 기각하게 될 최대 허용 확률</strong>이다. 따라서 <span class="math notranslate nohighlight">\(p\)</span>값이 유의수준보다 크면 귀무가설을 기각할 수 없고, 그렇지 않으면 귀무가설을 기각할 수 있다. 우리는 <span class="math notranslate nohighlight">\(\beta_1\)</span>이 0이라는 <strong>귀무가설을 기각할 때</strong> 해당 변수(즉 <span class="math notranslate nohighlight">\(x_1\)</span>)가 <strong>통계적으로 유의하다</strong>(statistically significant)고 말한다.</p>
</section>
<section id="id11">
<h3>추정 결과 해석<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<p>앞의 TV 광고 사례 추정 결과를 보면, TV 변수의 <span class="math notranslate nohighlight">\(t\)</span>-통계량은 17.67이다. 추정 계수가 표준오차의 2배만 넘어도 5% 유의수준에서 <span class="math notranslate nohighlight">\(\beta_1=0\)</span>을 기각할 수 있는데, 17.67배나 되기 때문에 매우 큰 값이며, 5% 수준에서는 당연히 귀무가설을 기각할 수 있다.</p>
<p><span class="math notranslate nohighlight">\(t\)</span>-통계량이 이 정도면 <span class="math notranslate nohighlight">\(p\)</span>값은 사실상 0에 가까운데, 최소한 0.001(즉 0.1%)보다는 작다. 따라서 유의수준이 0.1%인 경우에도 귀무가설을 기각할 수 있다. 결국 매출을 결정짓는 설명변수(또는 예측변수)로서 TV 광고는 통계적으로 매우 유의하다고 말할 수 있다.</p>
</section>
<section id="id12">
<h3>모델의 정확성 평가<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<p>선형 회귀 피팅의 성과는 일반적으로 <strong>잔차표준오차</strong>(RSE: residual standard error)와 <span class="math notranslate nohighlight">\(R^2\)</span>(R squared) 두 가지로 평가된다.</p>
<p><strong>RSE</strong></p>
<p><span class="math notranslate nohighlight">\({\rm RSE}\)</span>는 회귀 모델 오차항인 <span class="math notranslate nohighlight">\(\epsilon\)</span>의 표준편차 추정치이다. 그 의미를 대략적으로 말하면 <strong>반응이 실제 회귀선에서 벗어날 평균 크기</strong>이다. 다음 공식을 사용하여 계산된다.(여기서 <span class="math notranslate nohighlight">\({\rm RSS}\)</span>는 위에서 정의된 대로 <span class="math notranslate nohighlight">\(\sum_{i=1}^{n} \left( y_i-\hat y_i \right)  ^2\)</span>이다.)</p>
<div class="math notranslate nohighlight">
\[ {\rm RSE} = \sqrt{\frac{1}{n-2} \rm RSS} \]</div>
<p><span class="math notranslate nohighlight">\({\rm RSE}\)</span>는 회귀 모델이 데이터에 얼마나 적합하지 않은지 <strong>부적합(lack of fit)의 정도</strong>를 나타낸다. 모델을 사용하여 얻은 예측이 실제값에 매우 근접하면(즉, <span class="math notranslate nohighlight">\(i = 1,..., n\)</span>에 대해 <span class="math notranslate nohighlight">\(\hat y_i ≈ y_i\)</span>인 경우), <span class="math notranslate nohighlight">\({\rm RSE}\)</span>가 작을 것이며 모델은 데이터에 아주 적합할 것이다. 반면에 많은 관측에 있어서 <span class="math notranslate nohighlight">\(\hat y_i\)</span>가 <span class="math notranslate nohighlight">\(y_i\)</span>와 매우 멀리 떨어져 있다면, <span class="math notranslate nohighlight">\({\rm RSE}\)</span>가 상당히 커지며 이는 모델이 데이터에 적합하지 않음을 나타낸다.</p>
<p><strong><span class="math notranslate nohighlight">\(R^2\)</span></strong></p>
<p><span class="math notranslate nohighlight">\({\rm RSE}\)</span>는 부적합 정도가 <span class="math notranslate nohighlight">\(Y\)</span>의 단위로 측정되기 때문에 그 값 자체에 의미를 부여할 수 없다. 이와 달리 <span class="math notranslate nohighlight">\(R^2\)</span>는 항상 0과 1 사이의 값을 취하고, <span class="math notranslate nohighlight">\(Y\)</span> 단위의 영향을 받지 않는다. 다음 공식을 사용하여 계산되는데, 여기서 <span class="math notranslate nohighlight">\({\rm TSS}\)</span>(total sum of squares)는 <span class="math notranslate nohighlight">\(\sum_{i=1}^{n}(y_i-\bar y)^2\)</span>이고, <span class="math notranslate nohighlight">\({\rm RSS}\)</span>는 위에서 정의된 대로이다.</p>
<div class="math notranslate nohighlight">
\[ R^2 = \frac{\rm TSS-RSS}{\rm TSS} = 1-\frac{\rm RSS}{\rm TSS}   \]</div>
<p><span class="math notranslate nohighlight">\({\rm TSS}\)</span>는 <span class="math notranslate nohighlight">\(Y\)</span>의 전체 변동(variation)을 측정하며 회귀가 수행되기 전에 <span class="math notranslate nohighlight">\(Y\)</span>에 내재된 변동의 양으로 생각될 수 있다. 이에 반해 <span class="math notranslate nohighlight">\({\rm RSS}\)</span>는 회귀를 수행한 후에도 설명되지 않는 변동의 양을 측정한다. 따라서 <span class="math notranslate nohighlight">\( {\rm TSS-RSS} \)</span>는 회귀를 수행하여 설명된(또는 제거된) <span class="math notranslate nohighlight">\(Y\)</span> 변동의 양을 의미한다. 이 점에서 <span class="math notranslate nohighlight">\(R^2\)</span>는 <strong><span class="math notranslate nohighlight">\(Y\)</span>의 총변동에서 <span class="math notranslate nohighlight">\(X\)</span>를 사용하여 설명된 변동이 차지하는 비율</strong>을 측정한다.</p>
<p><span class="math notranslate nohighlight">\(R^2\)</span>가 1에 가까우면, <span class="math notranslate nohighlight">\(Y\)</span> 변동의 상당 부분이 회귀에 의해 설명되었다는 것을 의미한다. <span class="math notranslate nohighlight">\(R^2\)</span>가 0에 가까우면, 회귀가 <span class="math notranslate nohighlight">\(Y\)</span>의 변동을 별로 설명하지 않았음을 나타낸다. 이는 선형 모델이 잘못되었거나, 또는 고유의 <span class="math notranslate nohighlight">\(\sigma^2\)</span>(오차항의 변동성)이 높기 때문에 발생할 수 있다.</p>
<p>위 광고 데이터 추정 결과를 보면 <span class="math notranslate nohighlight">\(R^2\)</span>가 0.612이다. 이는 <strong><span class="math notranslate nohighlight">\(Y\)</span>의 변동 중 61.2%가 회귀선에 의해 설명되었다</strong>고 말할 수 있다.</p>
<p><strong>그림을 통한 <span class="math notranslate nohighlight">\(R^2\)</span> 의미 이해</strong></p>
<p>아래 그림 6.2에서 4개의 검정색 동그라미 점들이 관측이다. 왼쪽 그림에 나와 있는 수평선은 <span class="math notranslate nohighlight">\(y\)</span>의 평균인 <span class="math notranslate nohighlight">\(\bar y\)</span>이고, 오른쪽 그림의 우상향 직선은 OLS 방법에 의해 구한 회귀선이다. 여기에서 <span class="math notranslate nohighlight">\({\rm TSS}\)</span>는 왼쪽 그림에서 사각형 면적을 모두 합한 것이고, <span class="math notranslate nohighlight">\({\rm RSS}\)</span>는 오른쪽 그림의 사각형 면적을 합한 것이다. 이렇게 정의하면 <span class="math notranslate nohighlight">\({\rm TSS}\)</span>를 <span class="math notranslate nohighlight">\(y\)</span>의 총변동, 그리고 <span class="math notranslate nohighlight">\({\rm RSS}\)</span>를 <span class="math notranslate nohighlight">\(y\)</span>의 총변동 중 회귀선에 의해 설명되지 않고 여전히 남아 있는 변동으로 해석할 수 있다.</p>
<p><span class="math notranslate nohighlight">\(y\)</span>값의 변동을 해당 직선과의 거리의 제곱, 즉 면적으로 파악하는 이유는 그냥 거리로만 측정하게 되면 마이너스 값이 생기기 때문이다. 그렇게 되면 그것들을 합쳤을 때 플러스와 마이너스가 서로 상쇄되는 문제가 발생하기 때문에 이를 막기 위해 거리를 제곱한 값으로 값의 변동을 측정하는 것이다.</p>
<p>그림을 보면 <span class="math notranslate nohighlight">\({\rm TSS}\)</span>에 비해 <span class="math notranslate nohighlight">\({\rm RSS}\)</span>가 작을수록 회귀선이 데이터를 더 잘 설명한다고 말할 수 있다. 바로 <span class="math notranslate nohighlight">\(R^2=1-\text{RSS/TSS}\)</span>가 이것을 측정하는 것이다. 즉 <span class="math notranslate nohighlight">\({\rm TSS}\)</span>에 비해 <span class="math notranslate nohighlight">\({\rm RSS}\)</span>가 작을수록 <span class="math notranslate nohighlight">\(R^2\)</span>값은 커져 1에 가까워지고, 그것은 곧 회귀선의 <strong>적합도</strong>(goodness of fit)가 높은 것을 의미한다.</p>
<p><strong>그림 6.2.</strong> 왼쪽 그림에서 빨간색 사각형 면적을 모두 합한 것이 <span class="math notranslate nohighlight">\({\rm TSS}\)</span>이고, 오른쪽 그림에서 파란색 사각형 면적을 모두 합한 것이 <span class="math notranslate nohighlight">\({\rm RSS}\)</span>이다. <span class="math notranslate nohighlight">\(R^2=1-\text{RSS/TSS}\)</span>로서 <span class="math notranslate nohighlight">\({\rm TSS}\)</span>에 비해 <span class="math notranslate nohighlight">\({\rm RSS}\)</span>가 작을수록 <span class="math notranslate nohighlight">\(R^2\)</span>가 1에 가깝다.</p>
<p><img alt="R^2 그림설명" src="https://raw.githubusercontent.com/pilsunchoi/images/main/6-2.png" /></p>
<ul class="simple">
<li><p>그림 출처: Wikipedia, “<a class="reference external" href="https://en.wikipedia.org/wiki/Coefficient_of_determination">Coefficient of determination</a>”</p></li>
</ul>
</section>
</section>
<section id="id13">
<h2>6.2 다중 선형 회귀<a class="headerlink" href="#id13" title="Link to this heading">#</a></h2>
<p><strong>다중 선형 회귀</strong>(multiple linear regression) 모델은 다음과 같으며, 단순 회귀에서는 회귀식의 우변에 <span class="math notranslate nohighlight">\(X\)</span>가 하나만 있는데, 다중 회귀에서는 <span class="math notranslate nohighlight">\(X\)</span>가 여러 개라는 점이 다르다.</p>
<div class="math notranslate nohighlight">
\[
Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 +...+\beta_p X_p + \epsilon
\]</div>
<p>여기서 <span class="math notranslate nohighlight">\(X_j\)</span>는 <span class="math notranslate nohighlight">\(j\)</span>번째 예측변수를 나타내며, <span class="math notranslate nohighlight">\(\beta_j\)</span>는 해당 변수와 반응변수 <span class="math notranslate nohighlight">\(Y\)</span>간의 연관성을 나타낸다. 즉, <strong><span class="math notranslate nohighlight">\(\beta_j\)</span>는 다른 모든 예측변수를 고정한 상태에서(즉, 다른 조건이 동일한 상태에서) <span class="math notranslate nohighlight">\(X_j\)</span>가 한 단위 증가할 때 <span class="math notranslate nohighlight">\(Y\)</span>가 평균적으로 얼마나 증가하는지</strong>를 나타낸다. 회귀 계수의 의미에 대한 보다 자세한 설명이 아래 &lt;부록: 선형 회귀 로그변수 계수 해석&gt;에 나와 있다.</p>
<section id="id14">
<h3>추정<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<p>단순 선형 회귀와 마찬가지로 회귀 계수 <span class="math notranslate nohighlight">\(\beta_0, \beta_1,...,\beta_p\)</span>는 알 수 없으며 추정되어야 한다. 추정값 <span class="math notranslate nohighlight">\(\hat \beta_0, \hat \beta_1,..., \hat \beta_p\)</span>이 주어지면 다음 식을 사용하여 예측할 수 있다.</p>
<div class="math notranslate nohighlight">
\[
\hat y = \hat \beta_0 + \hat \beta_1 x_1 + \hat \beta_2 x_2 +...+\hat \beta_p x_p
\]</div>
<p>OLS는 단순 선형 회귀와 마찬가지로 잔차 제곱의 합을 최소화하는 <span class="math notranslate nohighlight">\(\hat \beta_0, \hat \beta_1,..., \hat \beta_p\)</span>를 선택한다.</p>
<p><strong>예측변수가 2개인 경우</strong></p>
<p>다중 선형 회귀에서 가장 간단한 경우인 예측변수가 2개만 있는 경우를 생각해보자. 이 경우 예측변수 2개에 반응변수 1개까지 포함하면 3차원 설정이 되며(아래 그림 6.3), 여기에서 최소제곱 회귀식은 <strong>평면</strong>이 된다. OLS 평면은 각 관측(빨간색으로 표시)과 회귀 평면 사이의 수직 거리를 제곱한 것의 합을 최소화하는 방식으로 선택된다.</p>
<p><strong>그림 6.3.</strong> 예측변수가 2개이고, 반응이 하나 있는 3차원 설정에서 최소제곱 회귀식은 평면이 된다. 평면은 각 관측(빨간색으로 표시)과 평면간 수직 거리의 제곱합을 최소화하도록 선택된다.</p>
<p><img alt="3차원 최소제곱" src="https://raw.githubusercontent.com/pilsunchoi/images/main/6-3.png" /></p>
<ul class="simple">
<li><p>그림 출처: ISLP, FIGURE 3.4</p></li>
</ul>
<p><strong><code class="docutils literal notranslate"><span class="pre">Advertising</span></code> 데이터세트 추정</strong></p>
<p>아래는 <code class="docutils literal notranslate"><span class="pre">statsmodels.formula.api</span></code>로 추정한 OLS 회귀 결과이다. 반응변수는 <code class="docutils literal notranslate"><span class="pre">Sales</span></code>, 예측변수는 <code class="docutils literal notranslate"><span class="pre">TV</span></code>, <code class="docutils literal notranslate"><span class="pre">Radio</span></code>, <code class="docutils literal notranslate"><span class="pre">Newspaper</span></code>이다. 기본 구문은 <code class="docutils literal notranslate"><span class="pre">smf.ols(</span> <span class="pre">'y</span> <span class="pre">~</span> <span class="pre">x1</span> <span class="pre">+</span> <span class="pre">x2</span> <span class="pre">+</span> <span class="pre">x3',</span> <span class="pre">data)</span></code>이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lm_fit</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;Sales ~ TV + Radio + Newspaper&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">advertising</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lm_fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                  Sales   R-squared:                       0.897
Model:                            OLS   Adj. R-squared:                  0.896
Method:                 Least Squares   F-statistic:                     570.3
Date:                Fri, 17 Oct 2025   Prob (F-statistic):           1.58e-96
Time:                        23:57:36   Log-Likelihood:                -386.18
No. Observations:                 200   AIC:                             780.4
Df Residuals:                     196   BIC:                             793.6
Df Model:                           3                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      2.9389      0.312      9.422      0.000       2.324       3.554
TV             0.0458      0.001     32.809      0.000       0.043       0.049
Radio          0.1885      0.009     21.893      0.000       0.172       0.206
Newspaper     -0.0010      0.006     -0.177      0.860      -0.013       0.011
==============================================================================
Omnibus:                       60.414   Durbin-Watson:                   2.084
Prob(Omnibus):                  0.000   Jarque-Bera (JB):              151.241
Skew:                          -1.327   Prob(JB):                     1.44e-33
Kurtosis:                       6.332   Cond. No.                         454.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
</section>
<section id="f">
<h3>F-통계량<a class="headerlink" href="#f" title="Link to this heading">#</a></h3>
<p>단순 선형 회귀에서는 반응과 예측변수 사이에 관련성이 있는지 확인하기 위해 <span class="math notranslate nohighlight">\(\beta_1 = 0\)</span>을 검증했다. 마찬가지로 다중 회귀에서는 예측변수가 <span class="math notranslate nohighlight">\(p\)</span>개 있기 때문에 <span class="math notranslate nohighlight">\(p\)</span>개의 모든 회귀 계수가 0인지를 확인하면 된다. 따라서 귀무가설은 다음과 같다.</p>
<div class="math notranslate nohighlight">
\[
H_0: \beta_1= \beta_2=...=\beta_p=0
\]</div>
<p>이에 대해 대립가설은 다음과 같다.</p>
<div class="math notranslate nohighlight">
\[ H_1:\text{at least one $\beta_j$ is non-zero.}\]</div>
<p>이 가설검정은 <span class="math notranslate nohighlight">\(F\)</span>-통계량을 이용해 행해진다.</p>
<div class="math notranslate nohighlight">
\[
F=\frac{({\rm TSS-RSS})/ p}{{\rm RSS}/(n - p - 1)}
\]</div>
<p>여기서 <span class="math notranslate nohighlight">\({\rm TSS}\)</span>와 <span class="math notranslate nohighlight">\({\rm RSS}\)</span>는 단순 선형 회귀와 마찬가지로 <span class="math notranslate nohighlight">\( {\rm TSS} = \sum_{i=1}^{n}(y_i-\bar y)^2\)</span>이고, <span class="math notranslate nohighlight">\({\rm RSS}= \sum_{i=1}^{n}(y_i-\hat y_i)^2\)</span>이다. 귀무가설이 참이면 <span class="math notranslate nohighlight">\(F\)</span>-통계량이 0에 가까운 값이 되고, 대립가설이 참이면 <span class="math notranslate nohighlight">\(F\)</span>-통계량의 값이 0보다 훨씬 큰 값이 된다.</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">Advertising</span></code> 데이터세트의 추정 결과</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">Sales</span></code>를 <code class="docutils literal notranslate"><span class="pre">Radio</span></code>, <code class="docutils literal notranslate"><span class="pre">TV</span></code>, <code class="docutils literal notranslate"><span class="pre">Newspaper</span></code>에 회귀하여 얻은 다중 선형 회귀 모델에 대한 <span class="math notranslate nohighlight">\(F\)</span>-통계량 값은 570이다. 이것은 0보다 훨씬 크므로 귀무가설 <span class="math notranslate nohighlight">\(H_0\)</span>에 반하는 강력한 증거를 제공한다. 즉, 적어도 하나의 광고 매체는 판매량과 관련을 맺고 있다는 것을 시사한다.</p>
<p>그런데 <span class="math notranslate nohighlight">\(F\)</span>-통계량이 얼마나 커야 <span class="math notranslate nohighlight">\(H_0\)</span>을 기각할 수 있을까? 그 대답은 <span class="math notranslate nohighlight">\(n\)</span>과 <span class="math notranslate nohighlight">\(p\)</span>의 값에 따라 달라진다. 즉 <span class="math notranslate nohighlight">\(n\)</span>이 아주 크다면 <span class="math notranslate nohighlight">\(F\)</span>-통계량이 조금만 0보다 커도 여전히 <span class="math notranslate nohighlight">\(H_0\)</span>에 반하는 증거를 제공 할 수 있다. 반대로 <span class="math notranslate nohighlight">\(n\)</span>이 아주 작은 경우에는 <span class="math notranslate nohighlight">\(H_0\)</span>을 기각하려면 <span class="math notranslate nohighlight">\(F\)</span>-통계량 값이 아주 커야 한다.</p>
<p><span class="math notranslate nohighlight">\(H_0\)</span>이 참이고 오차항 <span class="math notranslate nohighlight">\(\epsilon_i\)</span>가 정규분포를 따를 때 <span class="math notranslate nohighlight">\(F\)</span>-통계량은 <span class="math notranslate nohighlight">\(F\)</span>-분포를 따른다. 주어진 <span class="math notranslate nohighlight">\(n\)</span> 및 <span class="math notranslate nohighlight">\(p\)</span>값에 대해 (통계 소프트웨어 패키지를 사용하여) 주어진 <span class="math notranslate nohighlight">\(F\)</span>-통계량과 관련된 <span class="math notranslate nohighlight">\(p\)</span>값을 찾을 수 있으며, 이 <span class="math notranslate nohighlight">\(p\)</span>값으로 <span class="math notranslate nohighlight">\(H_0\)</span>을 기각할지 여부를 결정할 수 있다.</p>
<p><code class="docutils literal notranslate"><span class="pre">Advertising</span></code> 데이터세트의 경우, 위 결과에서 보듯이 <span class="math notranslate nohighlight">\(F\)</span>-통계량의 <span class="math notranslate nohighlight">\(p\)</span>값(1.58e-96)이 사실상 0이다. 즉, 세 가지 미디어 중 하나 이상이 판매 증가와 관련이 있다는 매우 강력한 증거가 있다고 말할 수 있다.</p>
</section>
<section id="id15">
<h3>모델 적합성<a class="headerlink" href="#id15" title="Link to this heading">#</a></h3>
<p>모델 적합성 평가는 주로 <span class="math notranslate nohighlight">\(\rm RSE\)</span>와 <span class="math notranslate nohighlight">\(R^2\)</span>로 이루어진다. 이들은 단순 선형 회귀와 동일한 방식으로 계산되고 해석된다.</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">Advertising</span></code> 데이터세트의 추정 결과</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">Sales</span></code>를 <code class="docutils literal notranslate"><span class="pre">Radio</span></code>, <code class="docutils literal notranslate"><span class="pre">TV</span></code>, <code class="docutils literal notranslate"><span class="pre">Newspaper</span></code>에 회귀시켜 얻은 다중 선형 회귀 모델의 <span class="math notranslate nohighlight">\(R^2\)</span>값은 0.8972이다. 이것은 앞에서 <code class="docutils literal notranslate"><span class="pre">Sales</span></code>를 <code class="docutils literal notranslate"><span class="pre">TV</span></code>에만 회귀시킨 단순 선형 회귀 모델의 <span class="math notranslate nohighlight">\(R^2\)</span>값 0.612에 비해 훨씬 높다.</p>
<p>일단 설명변수로 <code class="docutils literal notranslate"><span class="pre">TV</span></code> 외에 <code class="docutils literal notranslate"><span class="pre">Radio</span></code>만 추가시킬 경우 <span class="math notranslate nohighlight">\(R^2\)</span>값이 0.897로 뛰어 오른다(확인해 볼 것). 이는 <code class="docutils literal notranslate"><span class="pre">Radio</span></code> 변수가 <code class="docutils literal notranslate"><span class="pre">Sales</span></code>를 설명하는 데 중요하다는 것을 의미한다. 그런데 이는 다른 한편으로, <code class="docutils literal notranslate"><span class="pre">Newspaper</span></code> 변수의 경우에는 <code class="docutils literal notranslate"><span class="pre">Sales</span></code>를 설명하는 데 그다지 중요하지 않다는 것을 의미한다. 왜냐하면 <code class="docutils literal notranslate"><span class="pre">Newspaper</span></code> 변수가 모델에 추가되는 것이 <span class="math notranslate nohighlight">\(R^2\)</span>값을 거의 변화시키지 않기 때문이다. 이는 위 추정 결과에서 <code class="docutils literal notranslate"><span class="pre">Radio</span></code>와 <code class="docutils literal notranslate"><span class="pre">Newspaper</span></code> 계수 추정값의 <span class="math notranslate nohighlight">\(p\)</span>값을 비교해 봐도 알 수 있다.</p>
</section>
<section id="id16">
<h3>예측: 신뢰구간<a class="headerlink" href="#id16" title="Link to this heading">#</a></h3>
<p>다중 회귀 모델 피팅이 끝나면, 예측변수 <span class="math notranslate nohighlight">\(X_1, X_2, .., X_p\)</span>의 어떤 값에 대해 반응 <span class="math notranslate nohighlight">\(Y\)</span>를 예측하는 것은 간단한 일이다. 즉 다음과 같다.</p>
<div class="math notranslate nohighlight">
\[
\hat y = \hat \beta_0 + \hat \beta_1 x_1 + \hat \beta_2 x_2 +...+ \hat \beta_p x_p
\]</div>
<p><code class="docutils literal notranslate"><span class="pre">Advertising</span></code> 데이터세트에서 신뢰구간은 <strong>전체 도시의 평균적 판매</strong>에 대한 불확실성을 수치로 나타낸 것이다. 예를 들어, 각 도시의 TV 광고에 <span class="math notranslate nohighlight">\(\$\)</span>100,000이 지출되고 각 도시의 라디오 광고에 <span class="math notranslate nohighlight">\(\$\)</span>20,000가 지출되는 경우, 판매량에 대한 <strong>95% 신뢰구간</strong>이 [10,985, 11,528]로 추정됐다고 하자. 이는 이런 식으로 신뢰구간을 정할 경우, 그것들의 95%에 <span class="math notranslate nohighlight">\(Y\)</span>의 실제값이 포함된다는 의미이다. 즉, 주어진 <code class="docutils literal notranslate"><span class="pre">Advertising</span></code> 데이터세트처럼 여러번 데이터세트를 수집한 다음에 (TV에 <span class="math notranslate nohighlight">\(\$\)</span>100,000, 라디오 광고에 <span class="math notranslate nohighlight">\(\$\)</span>20,000를 광고한다는 전제 하에서), 평균 판매량에 대한 신뢰구간을 위와 같은 식으로 정하는 경우, 이들 신뢰구간의 95%에는 평균 판매의 실제값이 포함된다는 것이다.</p>
</section>
</section>
<section id="id17">
<h2>6.3 회귀 모델 기타 고려 사항<a class="headerlink" href="#id17" title="Link to this heading">#</a></h2>
<section id="id18">
<h3>정성적 예측변수<a class="headerlink" href="#id18" title="Link to this heading">#</a></h3>
<p>지금까지 논의에서는 선형 회귀 모델의 모든 변수가 정량적이라고 가정했다. 그러나 정성적 예측변수도 있을 수 있다. 이번에 로딩하는 <code class="docutils literal notranslate"><span class="pre">Credit</span></code> 데이터세트는 개인들의 신용카드 사용액과 관련된 데이터이다.(유의사항: 우리는 인터넷에서 데이터 파일을 불러들이는데 이것은 ISLP에서 제공하는 Credit.csv 파일과 변수 구성이 아주 약간 다르다.)</p>
<p><code class="docutils literal notranslate"><span class="pre">Credit</span></code> 데이터세트에는 <code class="docutils literal notranslate"><span class="pre">Balance</span></code>(각 개인의 월평균 신용카드 사용액)를 비롯해 여러 변수들이 있는데, <code class="docutils literal notranslate"><span class="pre">Age</span></code>(나이), <code class="docutils literal notranslate"><span class="pre">Cards</span></code>(신용카드 개수), <code class="docutils literal notranslate"><span class="pre">Education</span></code>(교육 년수), <code class="docutils literal notranslate"><span class="pre">Income</span></code>(소득, 단위: 천 달러), <code class="docutils literal notranslate"><span class="pre">Limit</span></code>(신용 한도), <code class="docutils literal notranslate"><span class="pre">Rating</span></code>(신용 등급) 등은 정량적 변수이다. 그런데 이런 정량적 변수 외에도 <code class="docutils literal notranslate"><span class="pre">Gender</span></code>(성별), <code class="docutils literal notranslate"><span class="pre">Student</span></code>(학생 여부), <code class="docutils literal notranslate"><span class="pre">Married</span></code>(결혼 여부), <code class="docutils literal notranslate"><span class="pre">Ethnicity</span></code>(백인, 아프리카계 미국인, 아시아인) 등의 정성적 변수도 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/JWarmenhoven/ISLR-python/master/Notebooks</span><span class="se">\</span>
<span class="s1">/Data/Credit.csv&#39;</span> <span class="c1"># 바로 윗 줄 마지막의 &quot;\&quot;은 다음 줄 입력이 계속 연결되는 것을 의미함</span>

<span class="n">Credit</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">)))</span>
<span class="n">Credit</span><span class="p">[</span><span class="s1">&#39;Student2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Credit</span><span class="o">.</span><span class="n">Student</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="s1">&#39;No&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Yes&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="n">Credit</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Income</th>
      <th>Limit</th>
      <th>Rating</th>
      <th>Cards</th>
      <th>Age</th>
      <th>Education</th>
      <th>Gender</th>
      <th>Student</th>
      <th>Married</th>
      <th>Ethnicity</th>
      <th>Balance</th>
      <th>Student2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>14.891</td>
      <td>3606</td>
      <td>283</td>
      <td>2</td>
      <td>34</td>
      <td>11</td>
      <td>Male</td>
      <td>No</td>
      <td>Yes</td>
      <td>Caucasian</td>
      <td>333</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>106.025</td>
      <td>6645</td>
      <td>483</td>
      <td>3</td>
      <td>82</td>
      <td>15</td>
      <td>Female</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>Asian</td>
      <td>903</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>104.593</td>
      <td>7075</td>
      <td>514</td>
      <td>4</td>
      <td>71</td>
      <td>11</td>
      <td>Male</td>
      <td>No</td>
      <td>No</td>
      <td>Asian</td>
      <td>580</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>148.924</td>
      <td>9504</td>
      <td>681</td>
      <td>3</td>
      <td>36</td>
      <td>11</td>
      <td>Female</td>
      <td>No</td>
      <td>No</td>
      <td>Asian</td>
      <td>964</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>55.882</td>
      <td>4897</td>
      <td>357</td>
      <td>2</td>
      <td>68</td>
      <td>16</td>
      <td>Male</td>
      <td>No</td>
      <td>Yes</td>
      <td>Caucasian</td>
      <td>331</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>범주가 두 개인 경우</strong></p>
<p>정성적 예측변수(요인(factor)이라고도 함)로서 두 개의 수준 또는 가능한 값만 있는 경우, 이를 회귀 모델에 통합하는 것은 매우 간단하다. 두 가지 가능한 숫자 값을 취하는 표시자(indicator) 또는 <strong>더미변수</strong>(dummy variable)를 생성하기만 하면 된다. 예를 들어 <code class="docutils literal notranslate"><span class="pre">Gender</span></code> 변수를 기반으로 다음 형식을 취하는 새 변수를 만들 수 있다.(아래와 같은 식으로 더미변수를 만들 경우, 보통 <code class="docutils literal notranslate"><span class="pre">female(여성)</span></code> 더미변수라고 부른다. 즉 1에 해당하는 범주를 더미변수의 이름으로 칭한다.)</p>
<div class="math notranslate nohighlight">
\[\begin{split}
x_i =
\begin{cases}
1, &amp; \text{if $i$th person is female} \\[2ex]
0, &amp; \text{if $i$th person is male}
\end{cases}
\end{split}\]</div>
<p>위 더미변수만을 예측변수로 사용하여 단순 회귀 모델을 구축하는 경우 다음과 같이 된다.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
y_i = \beta_0 + \beta_1 x_i + \epsilon_i=
\begin{cases}
\beta_0 + \beta_1 + \epsilon_i, &amp; \text{if $i$th person is female} \\[2ex]
\beta_0 + \epsilon_i, &amp; \text{if $i$th person is male}
\end{cases}
\end{split}\]</div>
<p>따라서 위 식을 잘 따져보면, <span class="math notranslate nohighlight">\(\beta_0\)</span>는 남성의 평균 카드 사용액이고, <span class="math notranslate nohighlight">\(\beta_0+\beta_1\)</span>은 여성의 평균 카드 사용액이며, <span class="math notranslate nohighlight">\(\beta_1\)</span>은 여성과 남성 카드 사용액의 평균적인 차이로 해석될 수 있다.</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">smf.ols</span></code>에서 정성적 예측변수 입력법</strong></p>
<p>앞에서 정성적 변수를 예측변수로 사용할 때는 더미변수를 만들어 입력하면 된다고 설명했다. 그런데 <code class="docutils literal notranslate"><span class="pre">smf.ols</span></code> 모듈은 우리가 굳이 더미변수를 만들지 않더라도 이 작업을 대신 해준다. 즉, 아래 예처럼 <code class="docutils literal notranslate"><span class="pre">Gender</span></code> 변수를 예측변수로 그냥 사용해도 파이썬이 스스로 알아서 이것이 범주형 범주라는 것을 인식하고, 관련된 더미변수를 만들어 추정한다는 것이다.</p>
<p>아래 추정 결과를 보면, 상수항(<code class="docutils literal notranslate"><span class="pre">Intercept</span></code>)과 <code class="docutils literal notranslate"><span class="pre">Gender[T.Female]</span></code> 변수가 있는데, 바로 후자가 위에서 설명한 “여성” 더미변수를 의미한다. 즉 <code class="docutils literal notranslate"><span class="pre">Gender</span></code> 변수로 만든 더미변수로서 <code class="docutils literal notranslate"><span class="pre">Female</span></code>이 <code class="docutils literal notranslate"><span class="pre">T</span></code>(True)이면, 1의 값을 갖는다는 의미이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">est</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;Balance ~ Gender&#39;</span><span class="p">,</span> <span class="n">Credit</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">est</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>====================================================================================
                       coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------------
Intercept          509.8031     33.128     15.389      0.000     444.675     574.931
Gender[T.Female]    19.7331     46.051      0.429      0.669     -70.801     110.267
====================================================================================
</pre></div>
</div>
</div>
</div>
<p>위 추정 결과를 앞에서 설명한 방식으로 해석하면, 남성의 평균 카드 사용액은 <span class="math notranslate nohighlight">\(\$\)</span>509.80이고, 여성의 평균 카드 사용액은 <span class="math notranslate nohighlight">\(\$\)</span>509.80 + <span class="math notranslate nohighlight">\(\$\)</span>19.73 = <span class="math notranslate nohighlight">\(\$\)</span>529.53으로서 평균적으로 여성이 남성에 비해 <span class="math notranslate nohighlight">\(\$\)</span>19.73을 추가적으로 사용하는 것으로 추정됐다.</p>
<p>그런데 더미변수에 대한 <span class="math notranslate nohighlight">\(p\)</span>값이 0.669로서 매우 높아 남녀 간 평균 카드 사용액의 차이에 통계적 증거가 없는 것으로 나타났다. 즉 통계적으로 유의하지 않다.</p>
<p>여성을 1로 코딩하고 남성을 0으로 코딩하는 결정은 임의적이며 회귀분석 결과에는 영향을 미치지 않지만 계수 해석이 달라진다. 남성을 1로 코딩하고 여성을 0으로 코딩했다면, <span class="math notranslate nohighlight">\(\beta_0\)</span> 및 <span class="math notranslate nohighlight">\(\beta_1\)</span>에 대한 추정치는 각각 529.53 및 -19.73이 되었을 것이다. 앞에서와 마찬가지로 남성은 카드 사용액이 평균 <span class="math notranslate nohighlight">\(\$\)</span>529.53 − <span class="math notranslate nohighlight">\(\$\)</span>19.73 = 509.80 달러, 여성은 529.53 달러가 된다.</p>
<p><strong>범주가 세 개 이상인 경우</strong></p>
<p>정성적 예측변수의 범주가 세 개 이상인 경우, 하나의 더미변수로는 가능한 모든 범주를 나타낼 수 없다. 이 경우에는 더미변수를 하나 더 만들면 된다. 예를 들어, <code class="docutils literal notranslate"><span class="pre">Ethnicity</span></code>(민족) 변수의 경우 두 개의 더미변수를 만들어야 한다. 첫 번째 더미변수는 가령 다음과 같다.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
x_{1i} =
\begin{cases}
1, &amp; \text{if $i$th person is an Asian} \\[2ex]
0, &amp; \text{if $i$th person is not an Asian}
\end{cases}
\end{split}\]</div>
<p>두 번째 더미변수는 가령 다음과 같다.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
x_{2i} =
\begin{cases}
1, &amp; \text{if $i$th person is a Caucasian} \\[2ex]
0, &amp; \text{if $i$th person is not a Caucasian}
\end{cases}
\end{split}\]</div>
<p>위 두 개의 더미변수만을 예측변수로 사용하여 회귀 모델을 구축하는 경우 회귀식은 다음과 같이 된다.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
y_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \epsilon_i=
\begin{cases}
\beta_0 + \beta_1 + \epsilon_i, &amp; \text{if $i$th person is an Asian} \\[2ex]
\beta_0 + \beta_2 + \epsilon_i, &amp; \text{if $i$th person is a Caucasian} \\[2ex]
\beta_0 + \epsilon_i, &amp; \text{if $i$th person is an African American}
\end{cases}
\end{split}\]</div>
<p>따라서 위 식을 잘 따져보면, <span class="math notranslate nohighlight">\(\beta_0\)</span>는 아프리카계 미국인의 평균 카드 사용액이고, <span class="math notranslate nohighlight">\(\beta_1\)</span>은 아시아계와 아프리카계 미국인 범주의 평균 카드 사용액의 차이이며, <span class="math notranslate nohighlight">\(\beta_2\)</span>는 백인과 아프리카계 미국인 간의 평균 카드 사용액의 차이에 해당한다.</p>
<p><strong>더미변수 개수 및 기준범주</strong></p>
<p>위 두 가지 더미변수 만드는 예(즉, <code class="docutils literal notranslate"><span class="pre">Gender</span></code> 더미변수 및 <code class="docutils literal notranslate"><span class="pre">Ethnicity</span></code> 더미변수)에서 우리는 어떤 변수가 갖고 있는 범주의 개수가 <span class="math notranslate nohighlight">\(c\)</span>일 때, 만들어야 하는 더미변수는 <span class="math notranslate nohighlight">\(c-1\)</span>개라는 것을 알 수 있다. 즉, <code class="docutils literal notranslate"><span class="pre">Gender</span></code> 변수는 남성과 여성의 두 개 범주를 가졌는데, 이때 우리는 <code class="docutils literal notranslate"><span class="pre">Female</span></code> 더미변수 하나만 만들었다. 또한 <code class="docutils literal notranslate"><span class="pre">Ethnicity</span></code> 변수는 세 개의 범주를 가졌는데, 이때 우리는 <code class="docutils literal notranslate"><span class="pre">Asian</span></code> 더미변수와 <code class="docutils literal notranslate"><span class="pre">Caucasian</span></code> 더미변수 두 개를 만들었다. 주어진 범주 중에서 어떤 범주에 대해 더미변수를 만드는지는 중요하지 않으며, 더미변수의 개수가 주어진 범주의 개수보다 하나 적어야 한다는 점이 중요하다. 그 이유는 더미변수의 개수가 하나 적어도 모든 정보를 커버하는 데 충분하기 때문이며, 모든 범주에 대해 더미변수를 만들 경우 오히려 정보가 중복되어 오류가 발생한다.</p>
<p>더미변수를 만들지 않는 범주(우리 예에서는 <code class="docutils literal notranslate"><span class="pre">Male</span></code> 범주 및 <code class="docutils literal notranslate"><span class="pre">African</span> <span class="pre">American</span></code> 범주)를 <strong>기준범주</strong>(baseline)라고 하는데, 더미변수의 추정 계수 해석과 관련해서는 이 기준범주가 말 그대로 기준이 된다.(앞의 <code class="docutils literal notranslate"><span class="pre">Gender</span></code> 변수와 <code class="docutils literal notranslate"><span class="pre">Ethnicity</span></code> 변수의 경우를 살펴보면, 이것이 무엇을 의미하는지 알 수 있을 것이다.)</p>
<p>아래 예에서는 범주형 변수인 <code class="docutils literal notranslate"><span class="pre">Ethnicity</span></code> 변수를 예측변수로 그냥 사용해도 파이썬이 스스로 알아서 이것이 범주형 범주라는 것을 인식하고, 관련된 더미변수를 2개 만들어 추정한 것을 볼 수 있다. 아래 추정 결과에서 <code class="docutils literal notranslate"><span class="pre">Ethnicity[T.Asian]</span></code> 변수는 <code class="docutils literal notranslate"><span class="pre">Asian</span></code>인 경우 1의 값을 갖는 더미변수이고, <code class="docutils literal notranslate"><span class="pre">Ethnicity[T.Caucasian]</span></code> 변수는 <code class="docutils literal notranslate"><span class="pre">Caucasian</span></code>인 경우 1의 값을 갖는 더미변수이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">est</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;Balance ~ Ethnicity&#39;</span><span class="p">,</span> <span class="n">Credit</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">est</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==========================================================================================
                             coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------------------
Intercept                531.0000     46.319     11.464      0.000     439.939     622.061
Ethnicity[T.Asian]       -18.6863     65.021     -0.287      0.774    -146.515     109.142
Ethnicity[T.Caucasian]   -12.5025     56.681     -0.221      0.826    -123.935      98.930
==========================================================================================
</pre></div>
</div>
</div>
</div>
<p>위 결과에서 기준범주인 아프리카계 미국인의 예상 잔액은 <span class="math notranslate nohighlight">\(\$\)</span>531.00이다. 아시아계 범주는 기준범주인 아프리카계 미국인 범주보다 사용액이 <span class="math notranslate nohighlight">\(\$\)</span>18.69 적고, 백인 범주는 기준범주인 아프리카계 미국인 범주보다 평균 카드 사용액이 <span class="math notranslate nohighlight">\(\$\)</span>12.50 적은 것으로 추정됐다. 그러나 두 개 더미변수의 계수 추정치와 관련된 <span class="math notranslate nohighlight">\(p\)</span>값이 매우 커서 카드 사용액이 인종 간에 차이가 난다는 통계적 증거가 없음을 시사한다.</p>
</section>
<section id="id19">
<h3>상호작용 항의 도입<a class="headerlink" href="#id19" title="Link to this heading">#</a></h3>
<p>우리는 앞에서 <code class="docutils literal notranslate"><span class="pre">Advertising</span></code> 데이터세트에 대한 분석에서 TV와 라디오 광고가 모두 판매량에 영향을 미친다는 결론을 내렸다. 그런데 이런 추론에서 TV 광고액의 평균 효과는 라디오 광고액에 관계없이 항상 <span class="math notranslate nohighlight">\(\beta_1\)</span>이고, 라디오 광고액의 평균 효과 역시 TV 광고액에 관계없이 항상 <span class="math notranslate nohighlight">\(\beta_2\)</span>가 된다.</p>
<p>그러나 이런 식의 추론이 올바르지 않을 수 있다. 가령 라디오 광고에 더 많을 돈을 지출할수록 TV 광고의 효과가 더 높아질 수도 있다. 마케팅에서는 이를 시너지(synergy) 효과라고 하며, 통계학에서는 이를 <strong>상호작용</strong>(interaction) 효과라고 한다.</p>
<p>두 개의 예측변수가 있는 표준 선형 회귀 모델을 생각해보자.</p>
<div class="math notranslate nohighlight">
\[
Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \epsilon
\]</div>
<p>이 모델에 따르면 <span class="math notranslate nohighlight">\(X_1\)</span>을 1단위 증가시키면 <span class="math notranslate nohighlight">\(Y\)</span>는 평균 <span class="math notranslate nohighlight">\(\beta_1\)</span> 단위 증가한다. 여기에서 <span class="math notranslate nohighlight">\(X_2\)</span>의 존재는 이 결과를 바꾸지 않는다. 즉, <span class="math notranslate nohighlight">\(X_2\)</span>의 값에 관계없이 <span class="math notranslate nohighlight">\(X_1\)</span>의 1단위 증가는 <span class="math notranslate nohighlight">\(Y\)</span>의 <span class="math notranslate nohighlight">\(\beta_1\)</span> 단위 증가로 이어진다.</p>
<p>상호작용 효과를 허용하도록 이 모델을 확장하는 한 가지 방법은 상호작용 항이라고 불리는 <span class="math notranslate nohighlight">\(X_1\)</span>과 <span class="math notranslate nohighlight">\(X_2\)</span>의 곱을 세 번째 예측변수로 포함시키는 것이다. 즉 다음과 같은 모델이다.</p>
<div class="math notranslate nohighlight">
\[
Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 +\beta_3 X_1 X_2 + \epsilon
\]</div>
<p>이렇게 상호작용 항을 포함시키면, 위 모델에 대한 해석이 어떻게 달라지는가? 위 식은 다음과 같이 쓸 수 있다.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
Y &amp;= \beta_0 + (\beta_1 + \beta_3 X_2)X_1 + \beta_2 X_2 + \epsilon \\[2ex]
  &amp;= \beta_0 + \tilde \beta_1 X_1 + \beta_2 X_2 + \epsilon
\end{aligned} 
\end{split}\]</div>
<p>여기서 <span class="math notranslate nohighlight">\(\tilde \beta_1 = \beta_1 + \beta_3 X_2\)</span>이다. 이 식에서 보듯이 <span class="math notranslate nohighlight">\(\tilde \beta_1\)</span>은 <span class="math notranslate nohighlight">\(X_2\)</span>가 어떤 값이냐에 따라 바뀌기  때문에 <span class="math notranslate nohighlight">\(X_1\)</span>이 <span class="math notranslate nohighlight">\(Y\)</span>에 미치는 영향은 더 이상 일정하지 않으며, <span class="math notranslate nohighlight">\(X_2\)</span>가 변함에 따라 <span class="math notranslate nohighlight">\(X_1\)</span>이 <span class="math notranslate nohighlight">\(Y\)</span>에 미치는 영향이 달라진다.</p>
<p><strong><code class="docutils literal notranslate"><span class="pre">smf.ols</span></code>에서 상호작용 항 입력법</strong></p>
<p>아래 예는 <code class="docutils literal notranslate"><span class="pre">Advertising</span></code> 데이터세트에 대한 분석에서 <code class="docutils literal notranslate"><span class="pre">TV</span></code>와 <code class="docutils literal notranslate"><span class="pre">Radio</span></code> 변수뿐만 아니라 이들 두 변수의 상호작용 항을 예측변수로 입력한 것이다. <code class="docutils literal notranslate"><span class="pre">smf.ols</span></code> 모듈에서는 우리가 굳이 두 변수를 곱해 상호작용 변수를 따로 만들지 않아도 예측변수 란에 <code class="docutils literal notranslate"><span class="pre">TV:Radio</span></code> 식으로 적으면 파이썬이 스스로 알아서 이것이 상호작용 항이라는 것을 인식하고, 관련 변수를 만들어 추정한다. 아래 추정 결과에서 <code class="docutils literal notranslate"><span class="pre">TV:Radio</span></code> 변수가 바로 상호작용 항에 해당한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">est</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;Sales ~ TV + Radio + TV:Radio&#39;</span><span class="p">,</span> <span class="n">advertising</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">est</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      6.7502      0.248     27.233      0.000       6.261       7.239
TV             0.0191      0.002     12.699      0.000       0.016       0.022
Radio          0.0289      0.009      3.241      0.001       0.011       0.046
TV:Radio       0.0011   5.24e-05     20.727      0.000       0.001       0.001
==============================================================================
</pre></div>
</div>
</div>
</div>
<p>위 결과는 상호작용 항을 포함하는 모형이 개별 효과만 포함하는 모형보다 더 우수하다는 것을 강력하게 시사한다. 즉. 상호작용 항인 <code class="docutils literal notranslate"><span class="pre">TV</span> <span class="pre">×</span> <span class="pre">Radio</span></code> 변수의 <span class="math notranslate nohighlight">\(p\)</span>값이 0에 가까워 <span class="math notranslate nohighlight">\(H_0:\beta_3=0\)</span>에 반하는 강력한 증거가 있음을 나타낸다.</p>
</section>
<section id="id20">
<h3>다항식 회귀<a class="headerlink" href="#id20" title="Link to this heading">#</a></h3>
<p>경우에 따라서는 반응과 예측변수 간의 관계가 비선형(nonlinear)일 수 있다. 이런 경우에는 <strong>다항식 회귀</strong>(polynomial regression)를 사용하여 비선형 관계를 피팅할 수 있다. ISLP에서 제공하는 <code class="docutils literal notranslate"><span class="pre">Auto</span></code> 데이터세트를 이용해 이를 시도해보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Auto</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../Data/Auto.csv&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;?&#39;</span><span class="p">])</span>
<span class="n">Auto</span> <span class="o">=</span> <span class="n">Auto</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">Auto</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>cylinders</th>
      <th>displacement</th>
      <th>horsepower</th>
      <th>weight</th>
      <th>acceleration</th>
      <th>year</th>
      <th>origin</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18.0</td>
      <td>8</td>
      <td>307.0</td>
      <td>130.0</td>
      <td>3504</td>
      <td>12.0</td>
      <td>70</td>
      <td>1</td>
      <td>chevrolet chevelle malibu</td>
    </tr>
    <tr>
      <th>1</th>
      <td>15.0</td>
      <td>8</td>
      <td>350.0</td>
      <td>165.0</td>
      <td>3693</td>
      <td>11.5</td>
      <td>70</td>
      <td>1</td>
      <td>buick skylark 320</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18.0</td>
      <td>8</td>
      <td>318.0</td>
      <td>150.0</td>
      <td>3436</td>
      <td>11.0</td>
      <td>70</td>
      <td>1</td>
      <td>plymouth satellite</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16.0</td>
      <td>8</td>
      <td>304.0</td>
      <td>150.0</td>
      <td>3433</td>
      <td>12.0</td>
      <td>70</td>
      <td>1</td>
      <td>amc rebel sst</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17.0</td>
      <td>8</td>
      <td>302.0</td>
      <td>140.0</td>
      <td>3449</td>
      <td>10.5</td>
      <td>70</td>
      <td>1</td>
      <td>ford torino</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Auto 데이터세트 변수</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mpg</span></code> : 연비(갤런 당 마일)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cylinders</span></code> : 실린더 개수</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">displacement</span></code> : 엔진 배기량(큐빅 인치)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">horsepower</span></code> : 엔진 마력</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weight</span></code> : 차량 무게(파운드)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">acceleration</span></code> : 정지 상태에서 시속 60마일 가속 시간(초)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">year</span></code> : 모델 연식</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">origin</span></code> : 자동차 원산지 (1. 미국, 2. 유럽, 3. 일본)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> : 차량 이름</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">origin</span></code>과 <code class="docutils literal notranslate"><span class="pre">name</span></code>은 정성적이고 나머지는 정량적이다. <code class="docutils literal notranslate"><span class="pre">origin</span></code> 변수는 숫자형이지만, 숫자가 범주를 구분하는 데 사용되기 때문에 범주형 변수이다.</p>
<p><strong>다항식 회귀선</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">seaborn</span></code>의 <code class="docutils literal notranslate"><span class="pre">regplot()</span></code>을 사용하면 고차 다항식(higher order polynomial) 추정 회귀선을 쉽게 그릴 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Auto</span><span class="o">.</span><span class="n">horsepower</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Auto</span><span class="o">.</span><span class="n">mpg</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> 
            <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> 
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Auto</span><span class="o">.</span><span class="n">horsepower</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Auto</span><span class="o">.</span><span class="n">mpg</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Linear&#39;</span><span class="p">,</span> 
            <span class="n">scatter</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Auto</span><span class="o">.</span><span class="n">horsepower</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Auto</span><span class="o">.</span><span class="n">mpg</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Degree 2&#39;</span><span class="p">,</span> 
            <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">scatter</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Auto</span><span class="o">.</span><span class="n">horsepower</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Auto</span><span class="o">.</span><span class="n">mpg</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Degree 5&#39;</span><span class="p">,</span> 
            <span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scatter</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">55</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">240</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c279647f09f56af8a1426e78c78a0befbf8a4b0c5757f012d9fa19efbba2e55b.png" src="../_images/c279647f09f56af8a1426e78c78a0befbf8a4b0c5757f012d9fa19efbba2e55b.png" />
</div>
</div>
<p>위 그림은 <code class="docutils literal notranslate"><span class="pre">Auto</span></code> 데이터세트에서 <code class="docutils literal notranslate"><span class="pre">mpg</span></code>(갤런 당 마일리지의 연비) 대 <code class="docutils literal notranslate"><span class="pre">horsepower</span></code>(마력)을 산점도로 그린 것이다. 여기서 오렌지색 선은 선형 회귀 피팅을 나타낸다. <code class="docutils literal notranslate"><span class="pre">mpg</span></code>와 <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> 사이에는 뚜렷한 관계가 있지만, 그 관계는 눈으로 보기에도 선형이 아니라 비선형 형태이다. 즉 데이터는 곡선의 관계를 시사한다. 이런 관계를 피팅할 수 있는 방법은 예측변수에 다음과 같은 2차항을 넣는 것이다.</p>
<div class="math notranslate nohighlight">
\[
{mpg} = \beta_0 + \beta_1 \times {horsepower} + \beta_2 \times {horsepower^2} + \epsilon
\]</div>
<p>위 식은 <code class="docutils literal notranslate"><span class="pre">horsepower</span></code>의 비선형 함수를 사용하여 <code class="docutils literal notranslate"><span class="pre">mpg</span></code>를 예측한다. 하지만 전체적으로 이것은 여전히 선형 모델이다. 즉, 위 식은 <span class="math notranslate nohighlight">\(X_1 = horsepower\)</span>, <span class="math notranslate nohighlight">\(X_2 = horsepower^2\)</span>인 다중 선형 회귀 모델이다.</p>
<p>위 그림의 파란색 곡선은 데이터에 대한 2차(quadratic) 피팅 결과를 보여준다. 2차 모델의 적합도가 선형 항만 포함되었을 때의 피팅보다 훨씬 더 나은 것으로 보인다. 아래는 2차항을 추가하여 2차 모델을 추정한 결과를 보여준다.(사실 2차항을 만들지 않고 <code class="docutils literal notranslate"><span class="pre">I(horsepower**2)</span></code> 또는 <code class="docutils literal notranslate"><span class="pre">np.power(horsepower**2)</span></code>을 입력해도 똑같은 결과를 얻는다.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Auto</span><span class="p">[</span><span class="s1">&#39;horsepower2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Auto</span><span class="o">.</span><span class="n">horsepower</span><span class="o">**</span><span class="mi">2</span>
<span class="n">Auto</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>cylinders</th>
      <th>displacement</th>
      <th>horsepower</th>
      <th>weight</th>
      <th>acceleration</th>
      <th>year</th>
      <th>origin</th>
      <th>name</th>
      <th>horsepower2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18.0</td>
      <td>8</td>
      <td>307.0</td>
      <td>130.0</td>
      <td>3504</td>
      <td>12.0</td>
      <td>70</td>
      <td>1</td>
      <td>chevrolet chevelle malibu</td>
      <td>16900.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>15.0</td>
      <td>8</td>
      <td>350.0</td>
      <td>165.0</td>
      <td>3693</td>
      <td>11.5</td>
      <td>70</td>
      <td>1</td>
      <td>buick skylark 320</td>
      <td>27225.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18.0</td>
      <td>8</td>
      <td>318.0</td>
      <td>150.0</td>
      <td>3436</td>
      <td>11.0</td>
      <td>70</td>
      <td>1</td>
      <td>plymouth satellite</td>
      <td>22500.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">est</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;mpg ~ horsepower + horsepower2&#39;</span><span class="p">,</span> <span class="n">Auto</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">est</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                    mpg   R-squared:                       0.688
Model:                            OLS   Adj. R-squared:                  0.686
Method:                 Least Squares   F-statistic:                     428.0
Date:                Fri, 17 Oct 2025   Prob (F-statistic):           5.40e-99
Time:                        23:57:37   Log-Likelihood:                -1133.2
No. Observations:                 392   AIC:                             2272.
Df Residuals:                     389   BIC:                             2284.
Df Model:                           2                                         
Covariance Type:            nonrobust                                         
===============================================================================
                  coef    std err          t      P&gt;|t|      [0.025      0.975]
-------------------------------------------------------------------------------
Intercept      56.9001      1.800     31.604      0.000      53.360      60.440
horsepower     -0.4662      0.031    -14.978      0.000      -0.527      -0.405
horsepower2     0.0012      0.000     10.080      0.000       0.001       0.001
==============================================================================
Omnibus:                       16.158   Durbin-Watson:                   1.078
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               30.662
Skew:                           0.218   Prob(JB):                     2.20e-07
Kurtosis:                       4.299   Cond. No.                     1.29e+05
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 1.29e+05. This might indicate that there are
strong multicollinearity or other numerical problems.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">est</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;mpg ~ horsepower&#39;</span><span class="p">,</span> <span class="n">Auto</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">est</span><span class="o">.</span><span class="n">rsquared</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6059482578894348
</pre></div>
</div>
</div>
</div>
<p>위 결과를 보면, 2차 피팅의 <span class="math notranslate nohighlight">\(R^2\)</span>는 0.688로서 앞의 선형 피팅(0.606)보다 우수하다. 또한 2차 항의 <span class="math notranslate nohighlight">\(p\)</span>값 역시 0에 가까운 값이라는 점도 2차 모델의 적합성을 말해준다.</p>
<p>그런데 이처럼 <span class="math notranslate nohighlight">\(horsepower^2\)</span>를 포함시켜 모델이 크게 향상 되었다면, 이번에는 추가로 <span class="math notranslate nohighlight">\(horsepower^3\)</span>, <span class="math notranslate nohighlight">\(horsepower^4\)</span>, <span class="math notranslate nohighlight">\(horsepower^5\)</span> 등을 포함시키면 어떻게 될까? 앞의 그림에서 녹색선이 1차부터 5차 항까지를 모두 포함시켜 얻은 결과이다. 결과를 보면, 피팅 곡선의 굴곡이 불필요하게 많아 보인다. 이는 고차 항을 무작정 많이 사용한다고 해서 피팅의 성과가 반드시 좋아진다는 보장은 없다는 것을 시사한다.</p>
</section>
</section>
<section id="id21">
<h2>6.4 선형 회귀 예제<a class="headerlink" href="#id21" title="Link to this heading">#</a></h2>
<p>코드 출처: <a class="github reference external" href="https://github.com/gperaza/ISLR-Python-Labs">gperaza/ISLR-Python-Labs</a></p>
<section id="id22">
<h3>보스턴 주택가격 데이터<a class="headerlink" href="#id22" title="Link to this heading">#</a></h3>
<p>ISLP에서 제공하는 Boston 주택 가격 데이터를 분석해보자(파일명: Boston.csv). 이 데이터세트는 보스턴 지역 506개 타운에 대해 <code class="docutils literal notranslate"><span class="pre">MEDV</span></code>(주택가격 중위값)를 기록한 것이다. <code class="docutils literal notranslate"><span class="pre">RM</span></code>(주택 당 평균 방 수), <code class="docutils literal notranslate"><span class="pre">AGE</span></code>(주택 평균 연령) 등 13개의 예측변수를 사용하여 <code class="docutils literal notranslate"><span class="pre">MEDV</span></code>를 예측하고자 한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Boston</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../Data/Boston.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">)</span>
<span class="n">Boston</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">upper</span><span class="p">,</span> <span class="n">Boston</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="c1"># 변수명 대문자로 바꾸기</span>
<span class="n">Boston</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CRIM</th>
      <th>ZN</th>
      <th>INDUS</th>
      <th>CHAS</th>
      <th>NOX</th>
      <th>RM</th>
      <th>AGE</th>
      <th>DIS</th>
      <th>RAD</th>
      <th>TAX</th>
      <th>PTRATIO</th>
      <th>LSTAT</th>
      <th>MEDV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.00632</td>
      <td>18.0</td>
      <td>2.31</td>
      <td>0</td>
      <td>0.538</td>
      <td>6.575</td>
      <td>65.2</td>
      <td>4.0900</td>
      <td>1</td>
      <td>296</td>
      <td>15.3</td>
      <td>4.98</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.02731</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0</td>
      <td>0.469</td>
      <td>6.421</td>
      <td>78.9</td>
      <td>4.9671</td>
      <td>2</td>
      <td>242</td>
      <td>17.8</td>
      <td>9.14</td>
      <td>21.6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.02729</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0</td>
      <td>0.469</td>
      <td>7.185</td>
      <td>61.1</td>
      <td>4.9671</td>
      <td>2</td>
      <td>242</td>
      <td>17.8</td>
      <td>4.03</td>
      <td>34.7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.03237</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0</td>
      <td>0.458</td>
      <td>6.998</td>
      <td>45.8</td>
      <td>6.0622</td>
      <td>3</td>
      <td>222</td>
      <td>18.7</td>
      <td>2.94</td>
      <td>33.4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.06905</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0</td>
      <td>0.458</td>
      <td>7.147</td>
      <td>54.2</td>
      <td>6.0622</td>
      <td>3</td>
      <td>222</td>
      <td>18.7</td>
      <td>5.33</td>
      <td>36.2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Boston 데이터세트 변수</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MEDV</span></code> : 1978년 보스턴의 506개 타운의 소유주 점유 주택 가격의 중위값(단위: 1,000달러)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CRIM</span></code> : 타운별 1인당 범죄율</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ZN</span></code> : 25,000 제곱피트 초과 거주지역 비율</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">INDUS</span></code> : 타운별 비소매 상업지역 면적 비율</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CHAS</span></code> : 지역이 찰스강에 접한 경우는 1, 아니면 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NOX</span></code> : 질소산화물 농도(천만 분의 1)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RM</span></code> : 주택당 평균 방 수</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AGE</span></code> : 소유주 점유 주택 중 1940년 이전 건축된 비율</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DIS</span></code> : 5개 보스턴 직업센터와의 가중평균 거리</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RAD</span></code> : 순환 고속도로까지의 접근성</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TAX</span></code> : 총재산세율(1만 달러당)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PTRATIO</span></code> : 타운별 학생/교사 비율</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LSTAT</span></code> : 인구 중 하위 계층 비율</p></li>
</ul>
<p><strong>단순 선형 회귀</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">smf.ols</span></code> 모듈을 사용하여 간단한 선형 회귀 모델을 추정해보자. 반응변수는 <code class="docutils literal notranslate"><span class="pre">MEDV</span></code>, 예측변수는 <code class="docutils literal notranslate"><span class="pre">LSTAT</span></code>이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lm</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;MEDV~LSTAT&#39;</span><span class="p">,</span> <span class="n">Boston</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>모델 추정 결과에 대한 정보를 프린트하기 위해 <code class="docutils literal notranslate"><span class="pre">summary()</span></code> 메서드를 사용한다. 이를 통해 계수에 대한 <span class="math notranslate nohighlight">\(p\)</span>값과 표준오차는 물론 모델에 대한 <span class="math notranslate nohighlight">\(R^2\)</span> 통계량 및 <span class="math notranslate nohighlight">\(F\)</span>-통계량 등을 얻을 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lm_fit</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lm_fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                   MEDV   R-squared:                       0.544
Model:                            OLS   Adj. R-squared:                  0.543
Method:                 Least Squares   F-statistic:                     601.6
Date:                Fri, 17 Oct 2025   Prob (F-statistic):           5.08e-88
Time:                        23:57:37   Log-Likelihood:                -1641.5
No. Observations:                 506   AIC:                             3287.
Df Residuals:                     504   BIC:                             3295.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     34.5538      0.563     61.415      0.000      33.448      35.659
LSTAT         -0.9500      0.039    -24.528      0.000      -1.026      -0.874
==============================================================================
Omnibus:                      137.043   Durbin-Watson:                   0.892
Prob(Omnibus):                  0.000   Jarque-Bera (JB):              291.373
Skew:                           1.453   Prob(JB):                     5.36e-64
Kurtosis:                       5.319   Cond. No.                         29.7
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<p>동일한 결과를 <code class="docutils literal notranslate"><span class="pre">smf(statsmodels.formula.api)</span></code> 모듈이 아니라 <code class="docutils literal notranslate"><span class="pre">sm(statsmodels.api)</span></code> 모듈을 사용하여 얻을 수도 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="n">lm1</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="s1">&#39;MEDV ~ LSTAT&#39;</span><span class="p">,</span> <span class="n">Boston</span><span class="p">)</span>
<span class="n">lm1_fit</span> <span class="o">=</span> <span class="n">lm1</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lm1_fit</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                   MEDV   R-squared:                       0.544
Model:                            OLS   Adj. R-squared:                  0.543
Method:                 Least Squares   F-statistic:                     601.6
Date:                Fri, 17 Oct 2025   Prob (F-statistic):           5.08e-88
Time:                        23:57:37   Log-Likelihood:                -1641.5
No. Observations:                 506   AIC:                             3287.
Df Residuals:                     504   BIC:                             3295.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     34.5538      0.563     61.415      0.000      33.448      35.659
LSTAT         -0.9500      0.039    -24.528      0.000      -1.026      -0.874
==============================================================================
Omnibus:                      137.043   Durbin-Watson:                   0.892
Prob(Omnibus):                  0.000   Jarque-Bera (JB):              291.373
Skew:                           1.453   Prob(JB):                     5.36e-64
Kurtosis:                       5.319   Cond. No.                         29.7
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<p>위 결과값의 많은 부분에 직접 액세스할 수 있는데, 가령 다음과 같이 하면 추정된 파라미터 리스트를 불러 올 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lm_fit</span><span class="o">.</span><span class="n">params</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intercept    34.553841
LSTAT        -0.950049
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>또한 계수 추정치에 대한 95% 신뢰구간을 얻기 위해서는 <code class="docutils literal notranslate"><span class="pre">conf_int()</span></code>를 사용하면 된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lm_fit</span><span class="o">.</span><span class="n">conf_int</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Intercept</th>
      <td>33.448457</td>
      <td>35.659225</td>
    </tr>
    <tr>
      <th>LSTAT</th>
      <td>-1.026148</td>
      <td>-0.873951</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>모델의 적합값(fitted values)은 다음과 같이 불러올 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lm_fit</span><span class="o">.</span><span class="n">fittedvalues</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1      29.822595
2      25.870390
3      30.725142
4      31.760696
5      29.490078
         ...    
502    25.366864
503    25.927393
504    29.195563
505    28.397521
506    27.067452
Length: 506, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>모델 추정을 바탕으로 어떤 주어진 <code class="docutils literal notranslate"><span class="pre">LSTAT</span></code> 값에 대해 <code class="docutils literal notranslate"><span class="pre">MEDV</span></code> 예측값의 <strong>신뢰구간</strong>(confidence interval)을 구할 수 있다. 아래는 <code class="docutils literal notranslate"><span class="pre">LSTAT</span></code>가 5, 10, 15의 세 가지 값에 대해 <code class="docutils literal notranslate"><span class="pre">MEDV</span></code> 예측값의 95% 신뢰구간을 구한 것이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictors</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;LSTAT&#39;</span><span class="p">:[</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">]})</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">lm_fit</span><span class="o">.</span><span class="n">get_prediction</span><span class="p">(</span><span class="n">predictors</span><span class="p">)</span>
<span class="n">predictions</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>mean_se</th>
      <th>mean_ci_lower</th>
      <th>mean_ci_upper</th>
      <th>obs_ci_lower</th>
      <th>obs_ci_upper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29.803594</td>
      <td>0.405247</td>
      <td>29.007412</td>
      <td>30.599776</td>
      <td>17.565675</td>
      <td>42.041513</td>
    </tr>
    <tr>
      <th>1</th>
      <td>25.053347</td>
      <td>0.294814</td>
      <td>24.474132</td>
      <td>25.632563</td>
      <td>12.827626</td>
      <td>37.279068</td>
    </tr>
    <tr>
      <th>2</th>
      <td>20.303101</td>
      <td>0.290893</td>
      <td>19.731588</td>
      <td>20.874613</td>
      <td>8.077742</td>
      <td>32.528459</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>예를 들어 <code class="docutils literal notranslate"><span class="pre">LSTAT</span></code> 값이 10인 경우, 95% 신뢰구간(<code class="docutils literal notranslate"><span class="pre">mean_ci_lower</span></code> 및 <code class="docutils literal notranslate"><span class="pre">mean_ci_upper</span></code>)은 [24.47, 25.63]이다.</p>
<p>한편, <strong>예측구간</strong>(prediction interval)은 전체 타운이 아니라 <strong>특정 타운</strong>의 주택가격을 둘러싼 불확실성을 수량화하는 데 사용된다. <code class="docutils literal notranslate"><span class="pre">LSTAT</span></code> 값이 10인 경우, 특정 타운의 주택가격에 대한 95% 예측구간은 [12.83, 37.28]이다. 이는 이런 식의 예측구간을 정할 경우, 그것의 95%가 <strong>해당 타운</strong>에 대한 <span class="math notranslate nohighlight">\(Y\)</span>의 실제값을 포함한다는 것을 의미한다. 신뢰구간과 예측구간의 중심은 똑같이 <span class="math notranslate nohighlight">\(\$\)</span>25.053이지만 예측구간은 신뢰구간보다 상당히 넓다. 여러 곳의 <strong>평균</strong> 주택가격(중위값)에 비해 <strong>특정</strong> 타운의 주택가격의 경우에는 불확실성이 증가하기 때문이다.</p>
<p>이제 <code class="docutils literal notranslate"><span class="pre">plot()</span></code> 함수를 사용하여 <code class="docutils literal notranslate"><span class="pre">MEDV</span></code> 및 <code class="docutils literal notranslate"><span class="pre">LSTAT</span></code> 관측값과 함께 최소제곱 회귀선을 그려보자. 그 전에 그래프에서 한글이 깨지는 것을 막기 위해서는 아래 명령문을 실행해야 한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">font_manager</span><span class="p">,</span> <span class="n">rc</span>
<span class="n">font_name</span> <span class="o">=</span> <span class="n">font_manager</span><span class="o">.</span><span class="n">FontProperties</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s2">&quot;c:/Windows/Fonts/malgun.ttf&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="n">font_name</span><span class="p">)</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.unicode_minus&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># 축에 마이너스 부호 제대로 나오게 하기</span>
</pre></div>
</div>
</div>
</div>
<p>위 코드는 Windows에 해당하는 것이고, MacBook의 경우에는 위 명령문 세 번째 줄을 다음과 같이 바꿔야 한다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">font_path</span> <span class="o">=</span> <span class="s2">&quot;/System/Library/Fonts/AppleSDGothicNeo.ttc&quot;</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 데이터, OLS 추정치, 예측 및 신뢰 구간을 그리기 위한 플롯 생성</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># 관측 그리기</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Boston</span><span class="o">.</span><span class="n">LSTAT</span><span class="p">,</span> <span class="n">Boston</span><span class="o">.</span><span class="n">MEDV</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> 
           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;관측&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># 모델 적합값 그리기</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Boston</span><span class="o">.</span><span class="n">LSTAT</span><span class="p">,</span> <span class="n">lm_fit</span><span class="o">.</span><span class="n">fittedvalues</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;OLS&quot;</span><span class="p">)</span>

<span class="c1"># 예측구간 및 신뢰구간을 표시하려면 모든 데이터 포인트에 대한 예측이 필요함</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">lm_fit</span><span class="o">.</span><span class="n">get_prediction</span><span class="p">(</span><span class="n">Boston</span><span class="p">)</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="c1"># 상방 및 하방 예측구간 그리기</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Boston</span><span class="o">.</span><span class="n">LSTAT</span><span class="p">,</span> <span class="n">predictions</span><span class="o">.</span><span class="n">obs_ci_lower</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.75&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;예측구간&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Boston</span><span class="o">.</span><span class="n">LSTAT</span><span class="p">,</span> <span class="n">predictions</span><span class="o">.</span><span class="n">obs_ci_upper</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.75&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="c1"># 상방 및 하방 신뢰구간 그리기</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Boston</span><span class="o">.</span><span class="n">LSTAT</span><span class="p">,</span> <span class="n">predictions</span><span class="o">.</span><span class="n">mean_ci_lower</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;평균 예측값 신뢰구간&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Boston</span><span class="o">.</span><span class="n">LSTAT</span><span class="p">,</span> <span class="n">predictions</span><span class="o">.</span><span class="n">mean_ci_upper</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;LSTAT&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;MEDV&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/53fd2d1d4aadd13e7af6a682fac5a15ce9a5fb59a6993d9b272e3ab825e58614.png" src="../_images/53fd2d1d4aadd13e7af6a682fac5a15ce9a5fb59a6993d9b272e3ab825e58614.png" />
</div>
</div>
<p><strong>다중 선형 회귀</strong></p>
<p>최소제곱을 사용하여 다중 선형 회귀 모델을 피팅하기 위해 다시 <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> 모듈을 사용한다. <code class="docutils literal notranslate"><span class="pre">smf.ols('y</span> <span class="pre">~</span> <span class="pre">x1</span> <span class="pre">+</span> <span class="pre">x2</span> <span class="pre">+</span> <span class="pre">x3',</span> <span class="pre">data)</span></code> 구문은 <code class="docutils literal notranslate"><span class="pre">x1</span></code>, <code class="docutils literal notranslate"><span class="pre">x2</span></code>, <code class="docutils literal notranslate"><span class="pre">x3</span></code>의 세 가지 예측변수가 있는 모델을 피팅하는 데 사용된다. <code class="docutils literal notranslate"><span class="pre">summary()</span></code> 함수는 모든 예측변수에 대해 회귀 계수를 반환한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="s1">&#39;MEDV ~ LSTAT + AGE&#39;</span><span class="p">,</span> <span class="n">Boston</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     33.2228      0.731     45.458      0.000      31.787      34.659
LSTAT         -1.0321      0.048    -21.416      0.000      -1.127      -0.937
AGE            0.0345      0.012      2.826      0.005       0.011       0.059
==============================================================================
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Boston</span></code> 데이터세트에는 13개의 변수가 있는데, 모든 예측변수를 사용하여 회귀를 수행하기 위해서는 이들 변수명을 모두 입력해야 한다. 변수가 아주 많을 때는 이 작업이 번거로울 것이기 때문에 ‘반응변수~예측변수’에 해당하는 부분(아래에서는 <code class="docutils literal notranslate"><span class="pre">my_formula</span></code>라는 이름으로 지정)을 다음과 같이 만들어 사용할 수도 있다. <code class="docutils literal notranslate"><span class="pre">join(preds)</span></code> 메서드는 반복되는 아이템의 모든 항목을 가져와서 하나의 문자열로 결합시키고자 할 때 사용한다. 아래 예에서는 <code class="docutils literal notranslate"><span class="pre">+</span></code>를 구분 기호로 사용하여 변수명 모든 항목을 하나의 문자열로 결합시켰다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preds</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Boston</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">preds</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;MEDV&#39;</span><span class="p">)</span>
<span class="n">my_formula</span> <span class="o">=</span> <span class="s1">&#39;MEDV~&#39;</span> <span class="o">+</span> <span class="s1">&#39;+&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">my_formula</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;MEDV~CRIM+ZN+INDUS+CHAS+NOX+RM+AGE+DIS+RAD+TAX+PTRATIO+LSTAT&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lm</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">my_formula</span><span class="p">,</span> <span class="n">Boston</span><span class="p">)</span>
<span class="n">lm_fit</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lm_fit</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     41.6173      4.936      8.431      0.000      31.919      51.316
CRIM          -0.1214      0.033     -3.678      0.000      -0.186      -0.057
ZN             0.0470      0.014      3.384      0.001       0.020       0.074
INDUS          0.0135      0.062      0.217      0.829      -0.109       0.136
CHAS           2.8400      0.870      3.264      0.001       1.131       4.549
NOX          -18.7580      3.851     -4.870      0.000     -26.325     -11.191
RM             3.6581      0.420      8.705      0.000       2.832       4.484
AGE            0.0036      0.013      0.271      0.787      -0.023       0.030
DIS           -1.4908      0.202     -7.394      0.000      -1.887      -1.095
RAD            0.2894      0.067      4.325      0.000       0.158       0.421
TAX           -0.0127      0.004     -3.337      0.001      -0.020      -0.005
PTRATIO       -0.9375      0.132     -7.091      0.000      -1.197      -0.678
LSTAT         -0.5520      0.051    -10.897      0.000      -0.652      -0.452
==============================================================================
</pre></div>
</div>
</div>
</div>
<p>위 <code class="docutils literal notranslate"><span class="pre">summary()</span></code> 결과의 개별 구성 요소에 다음과 같이 직접 액세스할 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># R 스퀘어</span>
<span class="n">lm_fit</span><span class="o">.</span><span class="n">rsquared</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7343070437613076
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># RSE(residual standard error), 즉 오차항 표준오차(표준편차 추정값)</span>
<span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lm_fit</span><span class="o">.</span><span class="n">mse_resid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.798034335596367
</pre></div>
</div>
</div>
</div>
<p>예측변수 중 가령 하나만을 제외한 모든 변수를 사용하여 회귀를 수행하려면 어떻게 해야할까? 예를 들어 위 회귀 분석 출력에서 <code class="docutils literal notranslate"><span class="pre">AGE</span></code>는 <span class="math notranslate nohighlight">\(p\)</span>값이 높다. 따라서 전체 예측변수 중에서 이 예측변수만을 제외하고 회귀를 실행하려면 다음과 같이 하면 된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preds</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Boston</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">preds</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;MEDV&#39;</span><span class="p">)</span>
<span class="n">preds</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;AGE&#39;</span><span class="p">)</span>
<span class="n">my_formula1</span> <span class="o">=</span> <span class="s1">&#39;MEDV~&#39;</span> <span class="o">+</span> <span class="s1">&#39;+&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
<span class="n">my_formula1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;MEDV~CRIM+ZN+INDUS+CHAS+NOX+RM+DIS+RAD+TAX+PTRATIO+LSTAT&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lm_fit</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">my_formula1</span><span class="p">,</span> <span class="n">Boston</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lm_fit</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     41.5251      4.920      8.441      0.000      31.859      51.191
CRIM          -0.1214      0.033     -3.683      0.000      -0.186      -0.057
ZN             0.0465      0.014      3.379      0.001       0.019       0.074
INDUS          0.0135      0.062      0.217      0.829      -0.109       0.135
CHAS           2.8528      0.868      3.287      0.001       1.148       4.558
NOX          -18.4851      3.714     -4.978      0.000     -25.782     -11.188
RM             3.6811      0.411      8.951      0.000       2.873       4.489
DIS           -1.5068      0.193     -7.825      0.000      -1.885      -1.128
RAD            0.2879      0.067      4.322      0.000       0.157       0.419
TAX           -0.0127      0.004     -3.333      0.001      -0.020      -0.005
PTRATIO       -0.9346      0.132     -7.099      0.000      -1.193      -0.676
LSTAT         -0.5474      0.048    -11.483      0.000      -0.641      -0.454
==============================================================================
</pre></div>
</div>
</div>
</div>
<p><strong>상호작용 항</strong></p>
<p>선형 모델에 상호작용 항을 포함시키는 것은 아주 간단하다. 예측변수를 집어 넣는 곳에 <code class="docutils literal notranslate"><span class="pre">LSTAT:BLACK</span></code> 구문을 사용하면 <code class="docutils literal notranslate"><span class="pre">LSTAT</span></code>와 <code class="docutils literal notranslate"><span class="pre">BLACK</span></code> 사이의 상호작용 항, 즉 <code class="docutils literal notranslate"><span class="pre">LSTAT</span></code> <span class="math notranslate nohighlight">\(\times\)</span> <code class="docutils literal notranslate"><span class="pre">BLACK</span></code>이 포함된다. 또한 <code class="docutils literal notranslate"><span class="pre">LSTAT*AGE</span></code> 구문은 <code class="docutils literal notranslate"><span class="pre">LSTAT</span></code>와 <code class="docutils literal notranslate"><span class="pre">AGE</span></code> 각각의 개별 변수에다 상호작용 항인 <code class="docutils literal notranslate"><span class="pre">LSTAT</span></code> <span class="math notranslate nohighlight">\(\times\)</span> <code class="docutils literal notranslate"><span class="pre">AGE</span></code>를 예측변수로 포함시키려 할 때 사용한다. 즉, <code class="docutils literal notranslate"><span class="pre">LSTAT*AGE</span></code>는 <code class="docutils literal notranslate"><span class="pre">LSTAT</span> <span class="pre">+</span> <span class="pre">AGE</span> <span class="pre">+</span> <span class="pre">LSTAT:AGE</span></code>를 간단히 줄여 쓴 셈이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lm_fit</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;MEDV ~ LSTAT*AGE&#39;</span><span class="p">,</span> <span class="n">Boston</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lm_fit</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     36.0885      1.470     24.553      0.000      33.201      38.976
LSTAT         -1.3921      0.167     -8.313      0.000      -1.721      -1.063
AGE           -0.0007      0.020     -0.036      0.971      -0.040       0.038
LSTAT:AGE      0.0042      0.002      2.244      0.025       0.001       0.008
==============================================================================
</pre></div>
</div>
</div>
</div>
<p><strong>예측변수의 비선형 변환</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">statsmodel</span></code>은 예측변수의 비선형 변환도 가능하다. 예를 들어 예측변수 <span class="math notranslate nohighlight">\(X\)</span>가 있을 때, <code class="docutils literal notranslate"><span class="pre">I(X**2)</span></code>로 하면 <span class="math notranslate nohighlight">\(X^2\)</span>가 된다. 아래 결과를 보면, <code class="docutils literal notranslate"><span class="pre">LSTAT</span></code> 2차 항의 <span class="math notranslate nohighlight">\(p\)</span>값이 0에 가깝다는 것은 2차 항을 포함시켜 모델이 개선됐다는 것을 의미한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lm_fit2</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;MEDV ~ LSTAT + I(LSTAT**2)&#39;</span><span class="p">,</span> <span class="n">Boston</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lm_fit2</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=================================================================================
                    coef    std err          t      P&gt;|t|      [0.025      0.975]
---------------------------------------------------------------------------------
Intercept        42.8620      0.872     49.149      0.000      41.149      44.575
LSTAT            -2.3328      0.124    -18.843      0.000      -2.576      -2.090
I(LSTAT ** 2)     0.0435      0.004     11.628      0.000       0.036       0.051
=================================================================================
</pre></div>
</div>
</div>
</div>
<p>예측변수의 비선형 변환에 다항식 변환만 있는 것은 아니다. 이번에는 로그 변환을 시도해보자. <code class="docutils literal notranslate"><span class="pre">numpy.log()</span></code>를 이용하면 된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;MEDV ~ np.log(LSTAT)&#39;</span><span class="p">,</span> <span class="n">Boston</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=================================================================================
                    coef    std err          t      P&gt;|t|      [0.025      0.975]
---------------------------------------------------------------------------------
Intercept        52.1248      0.965     54.004      0.000      50.228      54.021
np.log(LSTAT)   -12.4810      0.395    -31.627      0.000     -13.256     -11.706
=================================================================================
</pre></div>
</div>
</div>
</div>
</section>
<section id="level-vs-log">
<h3>Level 변수 vs Log 변수 계수의 해석<a class="headerlink" href="#level-vs-log" title="Link to this heading">#</a></h3>
<p>선형 회귀 모델의 로그변수 계수의 해석에 대해서는 아래 <a class="reference internal" href="#%EB%B6%80%EB%A1%9D:-%EC%84%A0%ED%98%95-%ED%9A%8C%EA%B7%80-%EB%A1%9C%EA%B7%B8%EB%B3%80%EC%88%98-%EA%B3%84%EC%88%98-%ED%95%B4%EC%84%9D"><span class="xref myst">부록: 선형 회귀 로그변수 계수 해석</span></a>에 자세한 설명에 나와 있다. 우선 로그변수가 들어있지 않은 선형 회귀 결과를 해석해보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;MEDV ~ NOX + DIS + RM + PTRATIO&#39;</span><span class="p">,</span>  <span class="n">Boston</span><span class="p">)</span> 
<span class="n">olsfit_1</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">olsfit_1</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     24.4422      5.097      4.795      0.000      14.428      34.456
NOX          -30.5997      3.512     -8.712      0.000     -37.500     -23.699
DIS           -0.9748      0.190     -5.121      0.000      -1.349      -0.601
RM             6.7664      0.400     16.934      0.000       5.981       7.551
PTRATIO       -1.2875      0.127    -10.138      0.000      -1.537      -1.038
==============================================================================
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">NOX</span></code> 변수 추정 계수 -30.60: 다른 조건이 동일한 가운데 <code class="docutils literal notranslate"><span class="pre">NOX</span></code>(질소산화물 농도)가 0.1만큼 더 높으면, <code class="docutils literal notranslate"><span class="pre">MEDV</span></code>(주택가격)이 평균적으로 3,060달러 더 낮으며, 이 결과는 통계적으로 유의하다(<span class="math notranslate nohighlight">\(p\)</span>값 0.000).</p></li>
</ul>
<p>이번에는 로그변수가 들어있는 선형 회귀 결과를 해석해보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;np.log(MEDV) ~ CRIM + CHAS + np.log(NOX) + PTRATIO&#39;</span><span class="p">,</span>  <span class="n">Boston</span><span class="p">)</span>
<span class="n">olsfit_2</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">olsfit_2</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===============================================================================
                  coef    std err          t      P&gt;|t|      [0.025      0.975]
-------------------------------------------------------------------------------
Intercept       3.8051      0.131     29.073      0.000       3.548       4.062
CRIM           -0.0135      0.002     -7.955      0.000      -0.017      -0.010
CHAS            0.2090      0.051      4.062      0.000       0.108       0.310
np.log(NOX)    -0.6660      0.072     -9.270      0.000      -0.807      -0.525
PTRATIO        -0.0619      0.006     -9.822      0.000      -0.074      -0.050
===============================================================================
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ln⁡(NOX)</span></code> 변수 추정 계수 -0.666: 다른 조건이 동일한 가운데 <code class="docutils literal notranslate"><span class="pre">NOX</span></code>(질소산화물 농도)가 1% 더 높으면, 주택가격이 평균적으로 0.666% 하락하며, 이 결과는 통계적으로 유의하다(<span class="math notranslate nohighlight">\(p\)</span>값 0.000).</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(\Delta X\)</span>는 <span class="math notranslate nohighlight">\(X\)</span>의 변화율을 의미하기 때문에 <code class="docutils literal notranslate"><span class="pre">ln⁡(NOX)</span></code>이 1단위 증가할 때, <code class="docutils literal notranslate"><span class="pre">MEDV</span></code>가 -0.666 단위 하락한다는 것은 <code class="docutils literal notranslate"><span class="pre">NOX</span></code>가 100% 높아지면, <code class="docutils literal notranslate"><span class="pre">MEDV</span></code>가 66.6% 낮아진다는 것을 의미하며, 이는 곧 <code class="docutils literal notranslate"><span class="pre">NOX</span></code>가 1% 높아지면, <code class="docutils literal notranslate"><span class="pre">MEDV</span></code>가 0.666% 낮아진다는 것을 의미한다.</p>
</section>
<section id="id23">
<h3>카시트 판매 데이터<a class="headerlink" href="#id23" title="Link to this heading">#</a></h3>
<p>이제 ISLP에서 제공하는 <code class="docutils literal notranslate"><span class="pre">Carseats</span></code> 데이터를 분석해보자. 이것은 어느 어린이용 카시트 판매회사의 400개 매장별 판매량과 관련된 데이터세트이다. 우리는 이 데이터세트의 여러 예측변수를 사용하여 카시트 판매를 예측하고자 한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Carseats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../Data/Carseats.csv&#39;</span><span class="p">)</span>
<span class="n">Carseats</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sales</th>
      <th>CompPrice</th>
      <th>Income</th>
      <th>Advertising</th>
      <th>Population</th>
      <th>Price</th>
      <th>ShelveLoc</th>
      <th>Age</th>
      <th>Education</th>
      <th>Urban</th>
      <th>US</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9.50</td>
      <td>138</td>
      <td>73</td>
      <td>11</td>
      <td>276</td>
      <td>120</td>
      <td>Bad</td>
      <td>42</td>
      <td>17</td>
      <td>Yes</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11.22</td>
      <td>111</td>
      <td>48</td>
      <td>16</td>
      <td>260</td>
      <td>83</td>
      <td>Good</td>
      <td>65</td>
      <td>10</td>
      <td>Yes</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10.06</td>
      <td>113</td>
      <td>35</td>
      <td>10</td>
      <td>269</td>
      <td>80</td>
      <td>Medium</td>
      <td>59</td>
      <td>12</td>
      <td>Yes</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7.40</td>
      <td>117</td>
      <td>100</td>
      <td>4</td>
      <td>466</td>
      <td>97</td>
      <td>Medium</td>
      <td>55</td>
      <td>14</td>
      <td>Yes</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.15</td>
      <td>141</td>
      <td>64</td>
      <td>3</td>
      <td>340</td>
      <td>128</td>
      <td>Bad</td>
      <td>38</td>
      <td>13</td>
      <td>Yes</td>
      <td>No</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong><code class="docutils literal notranslate"><span class="pre">Carseats</span></code> 데이터세트 변수</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Sales</span></code>: 매장의 판매량(단위: 천 개)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CompPrice</span></code>: 매장에서 경쟁사가 부과하는 가격</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Income</span></code>: 지역 소득 수준(천 달러)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Advertising</span></code>: 매장의 광고 예산(천 달러)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Population</span></code>: 지역의 인구 규모(천 명)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Price</span></code>: 매장이 부과하는 카시트 가격</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ShelveLoc</span></code>: 매장에서 카시트가 전시되는 매장 내 공간을 <code class="docutils literal notranslate"><span class="pre">Bad</span></code>, <code class="docutils literal notranslate"><span class="pre">Medium</span></code>, <code class="docutils literal notranslate"><span class="pre">Good</span></code>의 세 가지 등급으로 평가</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Age</span></code>: 지역 인구의 평균 연령</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Education</span></code>: 지역의 교육 수준</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Urban</span></code>: 매장이 도시에 있는지를 <code class="docutils literal notranslate"><span class="pre">Yes</span></code>와 <code class="docutils literal notranslate"><span class="pre">No</span></code>로 표시</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">US</span></code>: 매장이 미국내에 있는지를 <code class="docutils literal notranslate"><span class="pre">Yes</span></code>와 <code class="docutils literal notranslate"><span class="pre">No</span></code>로 표시</p></li>
</ul>
<p><strong>정성적 예측변수</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">Carseats</span></code> 데이터에는 전시 위치의 적절성을 나타내는 <code class="docutils literal notranslate"><span class="pre">ShelveLoc</span></code>와 같은 정성적(qualitative) 예측변수가 포함돼 있다. 즉, 각 매장에서 카시트가 전시되는 매장 내 공간을 평가한 것이다. 예측변수 <code class="docutils literal notranslate"><span class="pre">ShelveLoc</span></code>는  <code class="docutils literal notranslate"><span class="pre">Bad</span></code>, <code class="docutils literal notranslate"><span class="pre">Medium</span></code>, <code class="docutils literal notranslate"><span class="pre">Good</span></code>의 세 가지 값을 취한다. <code class="docutils literal notranslate"><span class="pre">Shelveloc</span></code>와 같은 정성적 변수를 입력하면 <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>는 자동으로 더미변수를 생성한다. 아래에서는 상호작용 항이 포함된 다중 회귀 모델을 피팅한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 전체 예측변수에다 두 개의 상호작용 항을 추가시킴</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">Carseats</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">formula</span> <span class="o">=</span><span class="s1">&#39;Sales ~ &#39;</span> <span class="o">+</span> <span class="s1">&#39; + &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; + Income:Advertising + Price:Age&#39;</span>
<span class="n">formula</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Sales ~ CompPrice + Income + Advertising + Population + Price + ShelveLoc + Age + Education + Urban + US + Income:Advertising + Price:Age&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lm_fit</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">Carseats</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lm_fit</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=======================================================================================
                          coef    std err          t      P&gt;|t|      [0.025      0.975]
---------------------------------------------------------------------------------------
Intercept               6.5756      1.009      6.519      0.000       4.592       8.559
ShelveLoc[T.Good]       4.8487      0.153     31.724      0.000       4.548       5.149
ShelveLoc[T.Medium]     1.9533      0.126     15.531      0.000       1.706       2.201
Urban[T.Yes]            0.1402      0.112      1.247      0.213      -0.081       0.361
US[T.Yes]              -0.1576      0.149     -1.058      0.291      -0.450       0.135
CompPrice               0.0929      0.004     22.567      0.000       0.085       0.101
Income                  0.0109      0.003      4.183      0.000       0.006       0.016
Advertising             0.0702      0.023      3.107      0.002       0.026       0.115
Population              0.0002      0.000      0.433      0.665      -0.001       0.001
Price                  -0.1008      0.007    -13.549      0.000      -0.115      -0.086
Age                    -0.0579      0.016     -3.633      0.000      -0.089      -0.027
Education              -0.0209      0.020     -1.063      0.288      -0.059       0.018
Income:Advertising      0.0008      0.000      2.698      0.007       0.000       0.001
Price:Age               0.0001      0.000      0.801      0.424      -0.000       0.000
=======================================================================================
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>는 카시트 전시 위치가 <code class="docutils literal notranslate"><span class="pre">Good</span></code>이면 1, 그렇지 않으면 0의 값을 취하는 <code class="docutils literal notranslate"><span class="pre">ShelveLoc</span> <span class="pre">[T.Good]</span> </code> 더미변수를 생성했다. 또한 전시 위치가 <code class="docutils literal notranslate"><span class="pre">Medium</span></code>이면 1이고 그렇지 않으면 0인 <code class="docutils literal notranslate"><span class="pre">ShelveLoc</span> <span class="pre">[T.Medium]</span></code> 더미변수를 생성했다. 전시 위치가 <code class="docutils literal notranslate"><span class="pre">Bad</span></code>인 경우는 두 개의 더미변수가 모두 0에 해당하며, 기준범주이다.</p>
<p>회귀 결과에서 <code class="docutils literal notranslate"><span class="pre">ShelveLoc</span> <span class="pre">[T.Good]</span></code> 계수가 플러스라는 사실은 전시 위치가 좋은 것이 (나쁜 위치에 비해) 높은 판매량과 연관돼있음을 의미한다. 그리고 <code class="docutils literal notranslate"><span class="pre">ShelveLoc</span> <span class="pre">[T.Medium]</span></code>은 플러스 계수이지만 크기가 더 작다. 이는 중간 위치가 (나쁜 위치에 비해서는) 판매량이 더 많지만, 좋은 위치보다는 판매량이 더 적음을 의미한다.</p>
<p><strong>추정 계수 해석</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mod</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;Sales ~ Price + Urban + US&#39;</span><span class="p">,</span> <span class="n">Carseats</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>================================================================================
                   coef    std err          t      P&gt;|t|      [0.025      0.975]
--------------------------------------------------------------------------------
Intercept       13.0435      0.651     20.036      0.000      11.764      14.323
Urban[T.Yes]    -0.0219      0.272     -0.081      0.936      -0.556       0.512
US[T.Yes]        1.2006      0.259      4.635      0.000       0.691       1.710
Price           -0.0545      0.005    -10.389      0.000      -0.065      -0.044
================================================================================
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Urban</span></code> 변수의 추정 계수는 통계적으로 유의하지 않으므로 이 변수와 매출간에 관련성이 없음을 나타낸다.<code class="docutils literal notranslate"><span class="pre">US</span></code>는 플러스 관계를 가진 정성적 변수이다. 이것은 관측(매장)이 US 소재일 때 판매량이 더 늘어나는 경향이 있음을 의미한다. 평균적으로 매장이 미국에 있는 경우 약 1,200개가 더 판매된다. <code class="docutils literal notranslate"><span class="pre">Price</span></code>는 마이너스 관계가 있는 정량적 변수이다. 이는 가격이 높을수록 판매량이 줄어드는 경향이 있음을 의미한다. 평균적으로 가격이 1달러 높아질 때 판매량은 약 55개 감소한다.</p>
<p><strong>추정 결과를 식으로 표현</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
{\it Sales} &amp;= 13.0435 - 0.0219 \times {\it Urban} + 1.2006 \times {\it US} - 0.0545 \times {\it Price} \\[3ex]
&amp;=
\begin{cases}
13.0435 - 0.0219 + 1.2006 - 0.0545 \times {\it Price}, &amp; \text{If } {\it Urban}=1, {\it US}=1 \\[2ex]
13.0435 - 0.0219 - 0.0545 \times {\it Price}, &amp; \text{If } {\it Urban}=1, {\it US}=0 \\[2ex]
13.0435 + 1.2006 - 0.0545 \times {\it Price}, &amp; \text{If } {\it Urban}=0, {\it US}=1 \\[2ex]
13.0435 - 0.0545 \times {\it Price}, &amp; \text{If } {\it Urban}=0, {\it US}=0
\end{cases}
\end{aligned}
\end{split}\]</div>
</section>
<section id="id24">
<h3>자동차 연비 데이터<a class="headerlink" href="#id24" title="Link to this heading">#</a></h3>
<p>ISLP에서 제공하는 <code class="docutils literal notranslate"><span class="pre">Auto</span></code> 데이터세트를 분석해보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Auto</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../Data/Auto.csv&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;?&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Auto</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">Auto</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(397, 9)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>cylinders</th>
      <th>displacement</th>
      <th>horsepower</th>
      <th>weight</th>
      <th>acceleration</th>
      <th>year</th>
      <th>origin</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18.0</td>
      <td>8</td>
      <td>307.0</td>
      <td>130.0</td>
      <td>3504</td>
      <td>12.0</td>
      <td>70</td>
      <td>1</td>
      <td>chevrolet chevelle malibu</td>
    </tr>
    <tr>
      <th>1</th>
      <td>15.0</td>
      <td>8</td>
      <td>350.0</td>
      <td>165.0</td>
      <td>3693</td>
      <td>11.5</td>
      <td>70</td>
      <td>1</td>
      <td>buick skylark 320</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18.0</td>
      <td>8</td>
      <td>318.0</td>
      <td>150.0</td>
      <td>3436</td>
      <td>11.0</td>
      <td>70</td>
      <td>1</td>
      <td>plymouth satellite</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16.0</td>
      <td>8</td>
      <td>304.0</td>
      <td>150.0</td>
      <td>3433</td>
      <td>12.0</td>
      <td>70</td>
      <td>1</td>
      <td>amc rebel sst</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17.0</td>
      <td>8</td>
      <td>302.0</td>
      <td>140.0</td>
      <td>3449</td>
      <td>10.5</td>
      <td>70</td>
      <td>1</td>
      <td>ford torino</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Auto 데이터세트 변수</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mpg</span></code> : 연비(갤런 당 마일)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cylinders</span></code> : 실린더 개수</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">displacement</span></code> : 엔진 배기량(큐빅 인치)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">horsepower</span></code> : 엔진 마력</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weight</span></code> : 차량 무게(파운드)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">acceleration</span></code> : 정지 상태에서 시속 60마일 가속 시간(초)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">year</span></code> : 모델 연식</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">origin</span></code> : 자동차 원산지 (1. 미국, 2. 유럽, 3. 일본)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> : 차량 이름</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">origin</span></code>과 <code class="docutils literal notranslate"><span class="pre">name</span></code>은 정성적이고 나머지는 정량적이다. <code class="docutils literal notranslate"><span class="pre">origin</span></code> 변수는 숫자형이지만, 숫자가 범주를 구분하는 데 사용되기 때문에 범주형 변수이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># origin 변수를 범주형으로 변환</span>
<span class="n">Auto</span><span class="p">[</span><span class="s1">&#39;origin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Auto</span><span class="p">[</span><span class="s1">&#39;origin&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 결측값 제거</span>
<span class="n">Auto</span> <span class="o">=</span> <span class="n">Auto</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">Auto</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(392, 9)
</pre></div>
</div>
</div>
</div>
<p><strong>상관계수 행렬</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Auto</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>cylinders</th>
      <th>displacement</th>
      <th>horsepower</th>
      <th>weight</th>
      <th>acceleration</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mpg</th>
      <td>1.000000</td>
      <td>-0.777618</td>
      <td>-0.805127</td>
      <td>-0.778427</td>
      <td>-0.832244</td>
      <td>0.423329</td>
      <td>0.580541</td>
    </tr>
    <tr>
      <th>cylinders</th>
      <td>-0.777618</td>
      <td>1.000000</td>
      <td>0.950823</td>
      <td>0.842983</td>
      <td>0.897527</td>
      <td>-0.504683</td>
      <td>-0.345647</td>
    </tr>
    <tr>
      <th>displacement</th>
      <td>-0.805127</td>
      <td>0.950823</td>
      <td>1.000000</td>
      <td>0.897257</td>
      <td>0.932994</td>
      <td>-0.543800</td>
      <td>-0.369855</td>
    </tr>
    <tr>
      <th>horsepower</th>
      <td>-0.778427</td>
      <td>0.842983</td>
      <td>0.897257</td>
      <td>1.000000</td>
      <td>0.864538</td>
      <td>-0.689196</td>
      <td>-0.416361</td>
    </tr>
    <tr>
      <th>weight</th>
      <td>-0.832244</td>
      <td>0.897527</td>
      <td>0.932994</td>
      <td>0.864538</td>
      <td>1.000000</td>
      <td>-0.416839</td>
      <td>-0.309120</td>
    </tr>
    <tr>
      <th>acceleration</th>
      <td>0.423329</td>
      <td>-0.504683</td>
      <td>-0.543800</td>
      <td>-0.689196</td>
      <td>-0.416839</td>
      <td>1.000000</td>
      <td>0.290316</td>
    </tr>
    <tr>
      <th>year</th>
      <td>0.580541</td>
      <td>-0.345647</td>
      <td>-0.369855</td>
      <td>-0.416361</td>
      <td>-0.309120</td>
      <td>0.290316</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>상관계수</strong>(correlation coefficient)에는 몇 가지 종류가 있는데, 가장 대표적인 것이 피어슨(Pearson) 상관계수이다. 그냥 상관계수라고 하면 보통 피어슨 상관계수를 말한다.상관계수는 두 변수 간에 <strong>선형</strong>(linear)의 상관관계를 측정하는 지표이다.</p>
<p>상관계수는 –1에서 1사이의 값을 가진다. 1은 완벽한 양(<span class="math notranslate nohighlight">\(+\)</span>)의 상관관계, –1은 완벽한 음(<span class="math notranslate nohighlight">\(-\)</span>)의 상관관계, 그리고 0은 상관관계가 없음을 의미한다. 1과 –1로 갈수록 상관관계가 강해지고, 0에 가까울수록 상관관계가 약해지는 것을 의미한다. 선형의 상관관계를 측정하기 때문에 두 변수 간의 관계가 비선형이면 둘 사이에 어떤 관계가 있어도 상관계수는 0에 가까울 수 있다.</p>
<p>아래 그림 6.4는 다양한 <span class="math notranslate nohighlight">\((X,Y)\)</span> 분포에 대해 상관계수 크기가 어느 정도인지를 보여준다. 모든 <span class="math notranslate nohighlight">\((X,Y)\)</span> 점들이 일직선 상에 있으면 상관계수가 1이나 혹은 –1이다. 이때 기울기가 양이면 상관계수가 1이고 기울기가 음이면 상관계수가 –1이다. 그림에서 가운데 줄을 보면, 상관계수에 있어서는 선형관계가 중요하지 기울기의 크기는 전혀 문제되지 않음을 알 수 있다. 맨 아랫줄에서 보듯이 <span class="math notranslate nohighlight">\((X,Y)\)</span> 간에 뚜렷한 비선형 관계가 있는데도 상관계수는 0으로 나올 수 있다.</p>
<p><strong>그림 6.4.</strong> 다양한 <span class="math notranslate nohighlight">\((X,Y)\)</span> 산점도에 대한 <span class="math notranslate nohighlight">\(X\)</span>와 <span class="math notranslate nohighlight">\(Y\)</span>의 상관계수</p>
<p><img alt="image.png" src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d4/Correlation_examples2.svg/1920px-Correlation_examples2.svg.png" /></p>
<ul class="simple">
<li><p>그림 출처: Wikipedia, “<a class="reference external" href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient">Pearson correlation coefficient</a>”</p></li>
</ul>
<p><strong>단순 선형 회귀</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mod</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;mpg ~ horsepower&#39;</span><span class="p">,</span> <span class="n">Auto</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                    mpg   R-squared:                       0.606
Model:                            OLS   Adj. R-squared:                  0.605
Method:                 Least Squares   F-statistic:                     599.7
Date:                Fri, 17 Oct 2025   Prob (F-statistic):           7.03e-81
Time:                        23:57:38   Log-Likelihood:                -1178.7
No. Observations:                 392   AIC:                             2361.
Df Residuals:                     390   BIC:                             2369.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     39.9359      0.717     55.660      0.000      38.525      41.347
horsepower    -0.1578      0.006    -24.489      0.000      -0.171      -0.145
==============================================================================
Omnibus:                       16.432   Durbin-Watson:                   0.920
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               17.305
Skew:                           0.492   Prob(JB):                     0.000175
Kurtosis:                       3.299   Cond. No.                         322.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<p><strong>추정 결과 해석</strong></p>
<p>위 추정 결과를 보면, 일단 예측변수와 반응변수 사이에 어떤 관계가 있다고 말할 수 있다. <span class="math notranslate nohighlight">\(F\)</span>-통계량이 0보다 훨씬 크고 <span class="math notranslate nohighlight">\(p\)</span>값이 사실상 0이기 때문에 회귀 계수가 0이라는 귀무가설을 기각할 수 있다. <span class="math notranslate nohighlight">\(R^2\)</span>값이 0.606이므로 <code class="docutils literal notranslate"><span class="pre">mpg</span></code> 변동성의 60.6%가 <code class="docutils literal notranslate"><span class="pre">horsepower</span></code>로 설명된다고 말할 수 있다. 또는 <code class="docutils literal notranslate"><span class="pre">mpg</span></code>의 변동 중 60.6%가 회귀선에 의해 설명된다고 말할 수 있다. <code class="docutils literal notranslate"><span class="pre">horsepower</span></code>에 해당하는 계수가 -0.1578이므로 둘 사이의 관계가 마이너스 관계이다.</p>
<p><strong>신뢰구간 및 예측구간</strong></p>
<p>가령 자동차의 마력(<code class="docutils literal notranslate"><span class="pre">horsepower</span></code>)이 98일 때, 연비(<code class="docutils literal notranslate"><span class="pre">mpg</span></code>)의 예측값, 그리고 95% 신뢰구간 및 예측구간은 다음과 같이 구할 수 있다. 예측된 <code class="docutils literal notranslate"><span class="pre">mpg</span></code>는 24.47이며, 95% 신뢰구간은 [23.97, 24.96]이고, 95% 예측구간은 [14.81, 34.12]이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictors</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;horsepower&#39;</span><span class="p">:[</span><span class="mi">98</span><span class="p">]})</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get_prediction</span><span class="p">(</span><span class="n">predictors</span><span class="p">)</span>
<span class="n">predictions</span><span class="o">.</span><span class="n">summary_frame</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>mean_se</th>
      <th>mean_ci_lower</th>
      <th>mean_ci_upper</th>
      <th>obs_ci_lower</th>
      <th>obs_ci_upper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>24.467077</td>
      <td>0.251262</td>
      <td>23.973079</td>
      <td>24.961075</td>
      <td>14.809396</td>
      <td>34.124758</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>최소제곱 회귀선 그림</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Auto</span><span class="p">[</span><span class="s1">&#39;horsepower&#39;</span><span class="p">],</span> <span class="n">Auto</span><span class="p">[</span><span class="s1">&#39;mpg&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Auto</span><span class="p">[</span><span class="s1">&#39;horsepower&#39;</span><span class="p">],</span> <span class="n">res</span><span class="o">.</span><span class="n">fittedvalues</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p><strong>다중 선형 회귀</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;mpg ~ cylinders + displacement + horsepower + weight + acceleration </span><span class="se">\</span>
<span class="s1">              + year + origin&#39;</span><span class="p">,</span> <span class="n">Auto</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                    mpg   R-squared:                       0.824
Model:                            OLS   Adj. R-squared:                  0.821
Method:                 Least Squares   F-statistic:                     224.5
Date:                Fri, 17 Oct 2025   Prob (F-statistic):          1.79e-139
Time:                        23:57:38   Log-Likelihood:                -1020.5
No. Observations:                 392   AIC:                             2059.
Df Residuals:                     383   BIC:                             2095.
Df Model:                           8                                         
Covariance Type:            nonrobust                                         
================================================================================
                   coef    std err          t      P&gt;|t|      [0.025      0.975]
--------------------------------------------------------------------------------
Intercept      -17.9546      4.677     -3.839      0.000     -27.150      -8.759
origin[T.2]      2.6300      0.566      4.643      0.000       1.516       3.744
origin[T.3]      2.8532      0.553      5.162      0.000       1.766       3.940
cylinders       -0.4897      0.321     -1.524      0.128      -1.121       0.142
displacement     0.0240      0.008      3.133      0.002       0.009       0.039
horsepower      -0.0182      0.014     -1.326      0.185      -0.045       0.009
weight          -0.0067      0.001    -10.243      0.000      -0.008      -0.005
acceleration     0.0791      0.098      0.805      0.421      -0.114       0.272
year             0.7770      0.052     15.005      0.000       0.675       0.879
==============================================================================
Omnibus:                       23.395   Durbin-Watson:                   1.291
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               34.452
Skew:                           0.444   Prob(JB):                     3.30e-08
Kurtosis:                       4.150   Cond. No.                     8.70e+04
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 8.7e+04. This might indicate that there are
strong multicollinearity or other numerical problems.
</pre></div>
</div>
</div>
</div>
<p>위 결과를 보면, 예측변수들과 반응 사이에 관련성이 있다. 위의 표에서 <span class="math notranslate nohighlight">\(F\)</span>-통계량 값이 1보다 훨씬 큰 252이므로 모든 변수의 계수가 0이라는 귀무가설을 기각할 수 있다. <span class="math notranslate nohighlight">\(H_0\)</span>이 참일때(즉, 실제로 모든 계수가 0일 때), 이런 식의 결과가 나올 확률은 <span class="math notranslate nohighlight">\(\text{Pr}(F\text{-statistic) = 2.04e-139}\)</span>로 사실상 0이다.</p>
<p>추정 결과에서 <span class="math notranslate nohighlight">\(p\)</span>값을 보면 어떤 예측변수가 반응변수와 통계적으로 유의한 관계가 있는지 확인할 수 있다. <code class="docutils literal notranslate"><span class="pre">displacement</span></code>, <code class="docutils literal notranslate"><span class="pre">weight</span></code>, <code class="docutils literal notranslate"><span class="pre">year</span></code>, <code class="docutils literal notranslate"><span class="pre">origin</span></code> 등은 통계적으로 유의한 반면, <code class="docutils literal notranslate"><span class="pre">cylinders</span></code>, <code class="docutils literal notranslate"><span class="pre">horsepower</span></code>, <code class="docutils literal notranslate"><span class="pre">acceleration</span></code> 등은 유의하지 않다.</p>
<p>추정 계수를 해석해보면, 가령 <code class="docutils literal notranslate"><span class="pre">year</span></code> 변수 계수의 의미는 다른 변수에 변화가 없을 때 자동차 연식이 1년 높아지면 평균적으로 <code class="docutils literal notranslate"><span class="pre">mpg</span></code>가 0.75만큼 높아진다. 즉, 최근의 차일수록 연비가 더 좋아진다.</p>
<p><strong>상호작용 항</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">Statsmodels</span></code>에서 <code class="docutils literal notranslate"><span class="pre">a:b</span></code>는 <code class="docutils literal notranslate"><span class="pre">a</span></code>와 <code class="docutils literal notranslate"><span class="pre">b</span></code>의 상호작용 항을 의미하며, <code class="docutils literal notranslate"><span class="pre">a*b</span></code>는 <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+</span> <span class="pre">b</span> <span class="pre">+</span> <span class="pre">a:b</span></code>를 의미한다.</p>
<p>아래 결과를 보면, <code class="docutils literal notranslate"><span class="pre">horsepower</span></code>와 <code class="docutils literal notranslate"><span class="pre">year</span></code>의 상호작용 항 계수의 <span class="math notranslate nohighlight">\(p\)</span>값이 0에 가까워 반응변수와 <code class="docutils literal notranslate"><span class="pre">horsepower:year</span></code> 사이의 관계는 통계적으로 유의한 관계가 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;mpg ~ horsepower*year + displacement + weight + origin&#39;</span><span class="p">,</span> <span class="n">Auto</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===================================================================================
                      coef    std err          t      P&gt;|t|      [0.025      0.975]
-----------------------------------------------------------------------------------
Intercept         -97.7517      9.633    -10.147      0.000    -116.693     -78.811
origin[T.2]         2.4066      0.515      4.669      0.000       1.393       3.420
origin[T.3]         2.3744      0.503      4.724      0.000       1.386       3.363
horsepower          0.7988      0.091      8.753      0.000       0.619       0.978
year                1.8453      0.127     14.508      0.000       1.595       2.095
horsepower:year    -0.0113      0.001     -9.057      0.000      -0.014      -0.009
displacement        0.0110      0.005      2.094      0.037       0.001       0.021
weight             -0.0056      0.001    -10.563      0.000      -0.007      -0.005
===================================================================================
</pre></div>
</div>
</div>
</div>
<p>예측변수가 7개인 경우 총 21개의 상호작용 항을 만들 수 있다. 단순화를 위해 이 중에서 <code class="docutils literal notranslate"><span class="pre">cylinders</span></code>와 <code class="docutils literal notranslate"><span class="pre">acceleration</span></code>이 들어있는 항들을 제외한 나머지 10개의 상호작용 항을 포함시켜 피팅한 결과가 아래 나와 있다. 결과를 보면, 5% 유의수준에서 통계적으로 유의한 상호작용은 <code class="docutils literal notranslate"><span class="pre">displacement:weight</span></code>, <code class="docutils literal notranslate"><span class="pre">horsepower:origin</span></code>, <code class="docutils literal notranslate"><span class="pre">horsepower:year</span></code>이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="s1">&#39;mpg ~ displacement + horsepower + origin + weight + year </span><span class="se">\</span>
<span class="s1">               + displacement:horsepower + displacement:origin </span><span class="se">\</span>
<span class="s1">               + displacement:weight + displacement:year + horsepower:origin </span><span class="se">\</span>
<span class="s1">               + horsepower:weight + horsepower:year + origin:weight </span><span class="se">\</span>
<span class="s1">               + origin:year + weight:year&#39;</span>
<span class="n">reg</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">Auto</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>============================================================================================
                               coef    std err          t      P&gt;|t|      [0.025      0.975]
--------------------------------------------------------------------------------------------
Intercept                  -49.8878     24.044     -2.075      0.039     -97.167      -2.608
origin[T.2]                -11.8015     10.679     -1.105      0.270     -32.801       9.198
origin[T.3]                 -8.1323     10.874     -0.748      0.455     -29.514      13.250
displacement                -0.1341      0.122     -1.097      0.273      -0.374       0.106
displacement:origin[T.2]    -0.0449      0.036     -1.244      0.214      -0.116       0.026
displacement:origin[T.3]     0.0791      0.027      2.960      0.003       0.027       0.132
horsepower                   0.9686      0.229      4.233      0.000       0.519       1.419
horsepower:origin[T.2]      -0.1170      0.032     -3.673      0.000      -0.180      -0.054
horsepower:origin[T.3]      -0.0591      0.047     -1.253      0.211      -0.152       0.034
weight                      -0.0214      0.016     -1.334      0.183      -0.053       0.010
origin[T.2]:weight           0.0055      0.002      2.951      0.003       0.002       0.009
origin[T.3]:weight          -0.0026      0.003     -0.952      0.342      -0.008       0.003
year                         1.3627      0.298      4.579      0.000       0.778       1.948
origin[T.2]:year             0.1819      0.139      1.313      0.190      -0.091       0.454
origin[T.3]:year             0.1441      0.140      1.033      0.302      -0.130       0.418
displacement:horsepower     -0.0002      0.000     -1.657      0.098      -0.000    4.22e-05
displacement:weight       3.113e-05   6.04e-06      5.152      0.000    1.92e-05     4.3e-05
displacement:year            0.0008      0.001      0.547      0.585      -0.002       0.004
horsepower:weight        -1.107e-05   1.81e-05     -0.612      0.541   -4.66e-05    2.45e-05
horsepower:year             -0.0119      0.003     -4.227      0.000      -0.017      -0.006
weight:year                  0.0001      0.000      0.656      0.512      -0.000       0.001
============================================================================================
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<p><strong><code class="docutils literal notranslate"><span class="pre">horsepower</span></code> 제곱, 로그, 제곱근 항</strong></p>
<p>아래 결과를 보면, <code class="docutils literal notranslate"><span class="pre">horsepower</span></code> 변수 자체는 물론이고, 제곱항, 로그항, 제곱근항의 <span class="math notranslate nohighlight">\(p\)</span>값이 모두 매우 낮은 수준으로 이들 전부가 통계적으로 유의하다는 것을 알 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;mpg ~ horsepower + np.power(horsepower,2) + np.log(horsepower) </span><span class="se">\</span>
<span class="s1">              + np.sqrt(horsepower) + weight + year + origin&#39;</span><span class="p">,</span> <span class="n">Auto</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>===========================================================================================
                              coef    std err          t      P&gt;|t|      [0.025      0.975]
-------------------------------------------------------------------------------------------
Intercept                -445.1863    168.255     -2.646      0.008    -776.006    -114.367
origin[T.2]                 1.3452      0.468      2.877      0.004       0.426       2.264
origin[T.3]                 1.7684      0.470      3.764      0.000       0.845       2.692
horsepower                  8.7064      2.686      3.241      0.001       3.425      13.988
np.power(horsepower, 2)    -0.0062      0.002     -3.198      0.001      -0.010      -0.002
np.log(horsepower)        431.2363    145.608      2.962      0.003     144.945     717.527
np.sqrt(horsepower)      -237.1663     75.238     -3.152      0.002    -385.097     -89.236
weight                     -0.0048      0.000    -11.214      0.000      -0.006      -0.004
year                        0.7557      0.046     16.477      0.000       0.665       0.846
===========================================================================================
</pre></div>
</div>
</div>
</div>
</section>
<section id="id25">
<h3>ChatGPT Q&amp;A<a class="headerlink" href="#id25" title="Link to this heading">#</a></h3>
<blockquote>
<div><p><strong>아래의 추정에서 np.log(horsepower)의 추정 계수가 416이 나왔는데 이 경우 마력이 1% 증가할 때 mpg가 얼마나 증가한다는 것을 의미하는지?</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>reg = smf.ols(&#39;mpg ~ horsepower + np.power(horsepower,2) + np.log(horsepower) + np.sqrt(horsepower) + weight + year + origin&#39;, Auto).fit()
print(reg.summary().tables[1])
</pre></div>
</div>
</div></blockquote>
<hr class="docutils" />
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">np.log(horsepower)</span></code>의 추정 계수가 416이라는 것은 로그 변환된 마력(horsepower)이 1 단위 증가할 때, 연비(mpg)가 평균적으로 416만큼 증가한다는 것을 의미합니다. 그러나 여기서 주의해야 할 점은 마력이 로그 스케일로 변환되어 있다는 것입니다.</p>
<p>마력이 1% 증가할 때 연비가 어떻게 변하는지 계산하려면, 로그 변환된 관계를 이해해야 합니다. 로그 변환된 독립 변수의 경우, 계수는 백분율 변화에 대한 탄력성(elasticity)을 나타냅니다. 즉, 독립 변수가 1% 변할 때 종속 변수가 얼마나 변하는지를 나타내는 것입니다.</p>
<p>이 경우, 마력이 1% 증가할 때 연비의 변화는 다음과 같이 계산할 수 있습니다:</p>
<div class="math notranslate nohighlight">
\[\text{연비 변화} = \text{계수} \times \text{마력의 백분율 변화}\]</div>
<div class="math notranslate nohighlight">
\[\text{연비 변화} = 416 \times 0.01\]</div>
<p>따라서, 마력이 1% 증가할 때 연비는 평균적으로 약 4.16만큼 증가한다고 해석할 수 있습니다. 여기서 중요한 것은 이러한 해석이 선형 회귀 모델의 가정과 특정 범위 내에서만 유효하다는 점입니다. 마력의 전체 범위에 걸쳐서 동일하게 적용되지 않을 수 있으며, 모델의 다른 변수들도 연비에 영향을 미친다는 점을 고려해야 합니다.</p>
</div></blockquote>
</section>
</section>
<section id="id26">
<h2>부록: 선형 회귀 로그변수 계수 해석<a class="headerlink" href="#id26" title="Link to this heading">#</a></h2>
<section id="id27">
<h3>로그변화율<a class="headerlink" href="#id27" title="Link to this heading">#</a></h3>
<p>단순변화율은 단리(simple interest)의 개념이고, 로그변화율은 복리(compound interest)의 개념이다. 여기에서 로그는 자연로그(natural logarithm)이다.</p>
<p>변수 <span class="math notranslate nohighlight">\(V\)</span>의 값이 <span class="math notranslate nohighlight">\(V_1\)</span>에서 <span class="math notranslate nohighlight">\(V_2\)</span>로 변했을 때, 단순변화율(percent change)과 로그변화율(log difference)은 다음과 같다.</p>
<div class="math notranslate nohighlight">
\[ \text{Percent change} = \frac{V_2-V_1}{V_1} \]</div>
<div class="math notranslate nohighlight">
\[ \text{Log difference} = \ln(V_2) - \ln(V_1)\]</div>
<p><span class="math notranslate nohighlight">\(V_1\)</span>과 <span class="math notranslate nohighlight">\(V_2\)</span> 두 숫자의 차이가 비율적으로 크지 않다면, 단순변화율과 로그변화율의 차이 역시 크지 않다. 예를 들어 100과 101은 단순변화율로는 1%이고, 로그변화율로는 0.995%이다. 위 로그변화율은 <span class="math notranslate nohighlight">\(\ln \left(\frac{V_2}{V_1} \right)\)</span>와 동일하다. 변수 <span class="math notranslate nohighlight">\(V\)</span>의 로그변화율을 기호로는 <span class="math notranslate nohighlight">\(\Delta \ln V\)</span>로 표현할 수 있다.(위 로그변화율 정의를 기호로 표현한 것임.)</p>
<p><strong>로그변화율은 상승과 하락이 대칭적임</strong></p>
<p>100만원짜리 주식이 120만원으로 올랐다면 로그변화율은 +18.23%이고, 반대로 120만원에서 100만원으로 떨어졌다면 올랐을 때의 변화율에 마이너스만 붙여주면 된다. 즉, –18.23%이다.</p>
<p>하지만 단순변화율은 이게 성립하지 않는다. 100만원 투자가 120만원이 됐다면 단순변화율은 +20%고, 120만원이 100만원이 되는 경우 단순변화율은 –20%가 아니라 그보다 더 작다.</p>
<p><strong>로그변화율은 누적변화율 계산이 간단함</strong></p>
<p>예컨대 로그변화율 기준으로 어제 수익률이 <span class="math notranslate nohighlight">\(r_1\)</span>이고 오늘 수익률이 <span class="math notranslate nohighlight">\(r_2\)</span>인 경우, 이틀 동안의 총 수익률은 <span class="math notranslate nohighlight">\((r_1+r_2)\)</span>가 된다. 단순수익률에서는 이것이 근사적으로 성립할 수 있지만, 로그수익률의 경우에는 정확히 성립한다.</p>
</section>
<section id="id28">
<h3>로그변수와 한계효과<a class="headerlink" href="#id28" title="Link to this heading">#</a></h3>
<p><strong>계수 <span class="math notranslate nohighlight">\(\beta_1\)</span>의 의미</strong></p>
<p>만약 <span class="math notranslate nohighlight">\(x\)</span>와 <span class="math notranslate nohighlight">\(y\)</span>의 관계가 다음과 같다면,</p>
<div class="math notranslate nohighlight">
\[
y=\beta_0 + \beta_1 x
\]</div>
<p>다음이 성립한다.</p>
<div class="math notranslate nohighlight">
\[
\frac{\Delta y}{\Delta x}=\beta_1
\]</div>
<p>서로 관련 있는 두 변수 <span class="math notranslate nohighlight">\(x\)</span>와 <span class="math notranslate nohighlight">\(y\)</span>가 있을 때, <span class="math notranslate nohighlight">\(x\)</span>가 1단위 증가했을 때 <span class="math notranslate nohighlight">\(y\)</span>가 얼마만큼 변하는지(즉 <span class="math notranslate nohighlight">\(\Delta y/\Delta x\)</span>)를 <span class="math notranslate nohighlight">\(x\)</span>의 <span class="math notranslate nohighlight">\(y\)</span>에 대한 <strong>한계효과</strong>(marginal effect)라 한다. 따라서 위와 같은 관계가 있을 때, <span class="math notranslate nohighlight">\(\beta_1\)</span>은 <span class="math notranslate nohighlight">\(x\)</span>의 <span class="math notranslate nohighlight">\(y\)</span>에 대한 한계효과를 의미한다.</p>
<p><strong>Case 1: <span class="math notranslate nohighlight">\(y=\beta_0 + \beta_1 \ln(x)\)</span></strong></p>
<p>이 경우 다음이 성립한다.</p>
<div class="math notranslate nohighlight">
\[
\frac{\Delta y}{\Delta \ln(x)}=\beta_1
\]</div>
<p>따라서 <span class="math notranslate nohighlight">\(\beta_1\)</span>의 의미는 다음과 같다.</p>
<p>     <span class="math notranslate nohighlight">\(\bullet~~\)</span> <span class="math notranslate nohighlight">\(\ln(x)\)</span>가 1만큼 증가할 때 <span class="math notranslate nohighlight">\(y\)</span>는 <span class="math notranslate nohighlight">\(\beta_1\)</span>만큼 증가한다.</p>
<p>    <span class="math notranslate nohighlight">\(\Rightarrow\)</span> <span class="math notranslate nohighlight">\(\ln(x)\)</span>가 1/100만큼 증가할 때 <span class="math notranslate nohighlight">\(y\)</span>는 <span class="math notranslate nohighlight">\(\beta_1/100\)</span>만큼 증가한다.</p>
<p>    <span class="math notranslate nohighlight">\(\Rightarrow\)</span> <strong><span class="math notranslate nohighlight">\(x\)</span>가 1% 증가할 때 <span class="math notranslate nohighlight">\(y\)</span>는 <span class="math notranslate nohighlight">\(\beta_1/100\)</span>만큼 증가한다.</strong></p>
<p><strong>Case 2: <span class="math notranslate nohighlight">\(\ln(y)=\beta_0 + \beta_1 x\)</span></strong></p>
<p>이 경우 다음이 성립한다.</p>
<div class="math notranslate nohighlight">
\[
\frac{\Delta \ln(y)}{\Delta x}=\beta_1
\]</div>
<p>따라서 <span class="math notranslate nohighlight">\(\beta_1\)</span>의 의미는 다음과 같다.</p>
<p>     <span class="math notranslate nohighlight">\(\bullet~~\)</span> <span class="math notranslate nohighlight">\(x\)</span>가 1만큼 증가할 때 <span class="math notranslate nohighlight">\(\ln(y)\)</span>는 <span class="math notranslate nohighlight">\(\beta_1\)</span>만큼 증가한다.</p>
<p>    <span class="math notranslate nohighlight">\(\Rightarrow\)</span> <strong><span class="math notranslate nohighlight">\(x\)</span>가 1만큼 증가할 때 <span class="math notranslate nohighlight">\(y\)</span>는 <span class="math notranslate nohighlight">\(\beta_1 \times 100\)</span>% 증가한다.</strong></p>
<p><strong>Case 3: <span class="math notranslate nohighlight">\(\ln(y)=\beta_0 + \beta_1 \ln(x)\)</span></strong></p>
<p>이 경우 다음이 성립한다.</p>
<div class="math notranslate nohighlight">
\[
\frac{\Delta \ln(y)}{\Delta \ln(x)}=\beta_1
\]</div>
<p>따라서 <span class="math notranslate nohighlight">\(\beta_1\)</span>의 의미는 다음과 같다.</p>
<p>     <span class="math notranslate nohighlight">\(\bullet~~\)</span> <span class="math notranslate nohighlight">\(\ln(x)\)</span>가 1만큼 증가할 때 <span class="math notranslate nohighlight">\(\ln(y)\)</span>는 <span class="math notranslate nohighlight">\(\beta_1\)</span>만큼 증가한다.</p>
<p>    <span class="math notranslate nohighlight">\(\Rightarrow\)</span> <span class="math notranslate nohighlight">\(\ln(x)\)</span>가 1/100만큼 증가할 때 <span class="math notranslate nohighlight">\(\ln(y)\)</span>는 <span class="math notranslate nohighlight">\(\beta_1/100\)</span>만큼 증가한다.</p>
<p>    <span class="math notranslate nohighlight">\(\Rightarrow\)</span> <strong><span class="math notranslate nohighlight">\(x\)</span>가 1% 증가할 때 <span class="math notranslate nohighlight">\(y\)</span>는 <span class="math notranslate nohighlight">\(\beta_1\)</span>% 증가한다.(즉, 탄력성을 의미함.)</strong></p>
<p><strong>로그변수 해석 요약</strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>모델</p></th>
<th class="head text-center"><p>종속변수</p></th>
<th class="head text-center"><p>독립변수</p></th>
<th class="head text-left"><p><center>계수(<span class="math notranslate nohighlight">\(\beta\)</span>) 해석</center></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Level-level</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(y\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(x\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(x\)</span>가 1단위 증가할 때, <span class="math notranslate nohighlight">\(y\)</span>는 <span class="math notranslate nohighlight">\(\beta\)</span> 단위만큼 증가</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Level-log</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(y\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\ln(x)\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(x\)</span>가 1% 증가할 때, <span class="math notranslate nohighlight">\(y\)</span>는 <span class="math notranslate nohighlight">\(\beta/100\)</span> 단위만큼 증가</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Log-level</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\ln(y)\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(x\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(x\)</span>가 1단위 증가할 때, <span class="math notranslate nohighlight">\(y\)</span>는 <span class="math notranslate nohighlight">\(100 \times \beta\)</span>%만큼 증가</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Log-log</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\ln(y)\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\ln(x)\)</span></p></td>
<td class="text-left"><p><span class="math notranslate nohighlight">\(x\)</span>가 1% 증가할 때, <span class="math notranslate nohighlight">\(y\)</span>는 <span class="math notranslate nohighlight">\(\beta\)</span>%만큼 증가</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id29">
<h3>로그변수 해석 사례<a class="headerlink" href="#id29" title="Link to this heading">#</a></h3>
<p>자료 출처: Introductory Econometrics: A Modern Approach (by Jeffrey M. Wooldridge)</p>
<p><strong>임금 결정</strong></p>
<p>526명 근로자를 대상으로 교육 년수(<span class="math notranslate nohighlight">\(educ\)</span>), 경력 년수(<span class="math notranslate nohighlight">\(exper\)</span>), 근속 년수(<span class="math notranslate nohighlight">\(tenure\)</span>), 시간당 임금(<span class="math notranslate nohighlight">\(wage\)</span>, 달러) 변수를 이용하여 임금 결정 모델을 선형 회귀 모형으로 추정한 결과는 다음과 같다.</p>
<div class="math notranslate nohighlight">
\[
\widehat{ \ln⁡ ( wage )} =0.284+0.092~educ+0.0041~exper+0.022~tenure
\]</div>
<p>여기에서 <span class="math notranslate nohighlight">\(\hat\beta_1=0.092\)</span>의 의미는 다른 조건이 동일할 때 교육을 1년 더 받으면 임금이 평균적으로 9.2% 더 높다는 것이다.</p>
<p><strong>주택가격 결정(1)</strong></p>
<p>보스턴시 526개 타운을 대상으로 주택가격 중위값(<span class="math notranslate nohighlight">\(price\)</span>), 질소산화물 오염 정도(<span class="math notranslate nohighlight">\(nox\)</span>), 5개 고용센터와의 거리(<span class="math notranslate nohighlight">\(dist\)</span>), 해당지역 주택의 평균 방 개수(<span class="math notranslate nohighlight">\(rooms\)</span>), 해당지역 학교의 평균 학생/교사 비율(<span class="math notranslate nohighlight">\(stratio\)</span>, 배수) 변수를 이용하여 주택가격 결정 모델을 선형 회귀 모형으로 추정한 결과는 다음과 같다.</p>
<div class="math notranslate nohighlight">
\[
\widehat{ \ln⁡ ( price )} =11.08−0.954\ln(nox)+0.134~dist+0.255~rooms-0.052~stratio
\]</div>
<p>여기에서 <span class="math notranslate nohighlight">\(\hat \beta_4=-0.052\)</span>의 의미는 다른 조건이 동일할 때 학생/교사 비율(배수)이 1만큼 높아지면 주택가격이 평균적으로 5.2% 더 낮다는 것이다.</p>
<p><strong>주택가격 결정(2)</strong></p>
<p>88개 주택을 대상으로 주택가격(<span class="math notranslate nohighlight">\(price\)</span>), 대지 면적(<span class="math notranslate nohighlight">\(lotsize\)</span>), 주택 면적(<span class="math notranslate nohighlight">\(sqrt\)</span>), 방 개수(<span class="math notranslate nohighlight">\(bdrms\)</span>), 콜로니얼 유형 여부(<span class="math notranslate nohighlight">\(colonial\)</span>) 변수를 이용하여 주택가격 결정 모델을 선형 회귀 모형으로 추정한 결과는 다음과 같다.</p>
<div class="math notranslate nohighlight">
\[
\widehat{ \ln⁡ ( price )} =-1.35+0.168\ln(lotsize)+0.707\ln(sqrt)+0.027~bdrms+0.054~colonial
\]</div>
<p>여기에서 <span class="math notranslate nohighlight">\(\hat \beta_4=0.054\)</span>의 의미는 다른 조건이 동일할 때 콜로니얼 형태의 주택이 평균적으로 가격이 5.4% 더 높다는 것이다.</p>
<p><strong>외모와 임금(남성 대상)</strong></p>
<p>Hamermesh와 Biddle(1994)의 연구로서 700명의 남성 직장인을 대상으로 외모와 기타 여러 변수들(<span class="math notranslate nohighlight">\(other~factors\)</span>)을 이용하여 임금 결정 모델을 선형 회귀 모형으로 추정한 결과는 다음과 같다. 여기에서 외모는 평균(<span class="math notranslate nohighlight">\(average\)</span>), 평균하회(<span class="math notranslate nohighlight">\(belavg\)</span>), 평균상회(<span class="math notranslate nohighlight">\(abvavg\)</span>)의 세 그룹으로 분류했다.</p>
<div class="math notranslate nohighlight">
\[
\widehat{ \ln⁡ (wage)} =\hat \beta_0-0.164~belavg+0.016~abvavg+other~factors
\]</div>
<p>여기에서 <span class="math notranslate nohighlight">\(\hat \beta_1=-0.164\)</span>의 의미는 다른 조건이 동일할 때, 평균하회 그룹의 임금이 평균 그룹에 비해 평균적으로 16.4% 더 낮다는 것이다.</p>
<p><strong>외모와 임금(여성 대상)</strong></p>
<p>Hamermesh와 Biddle(1994)의 연구로서 409명의 여성 직장인을 대상으로 외모와 기타 여러 변수들(<span class="math notranslate nohighlight">\(other~factors\)</span>)을 이용하여 임금 결정 모델을 선형 회귀 모형으로 추정한 결과는 다음과 같다. 여기에서 외모는 평균(<span class="math notranslate nohighlight">\(average\)</span>), 평균하회(<span class="math notranslate nohighlight">\(belavg\)</span>), 평균상회(<span class="math notranslate nohighlight">\(abvavg\)</span>)의 세 그룹으로 분류했다.</p>
<div class="math notranslate nohighlight">
\[
\widehat{ \ln⁡ (wage)} =\hat \beta_0-0.124~belavg+0.035~abvavg+other~factors
\]</div>
<p>여기에서 <span class="math notranslate nohighlight">\(\hat \beta_1=-0.124\)</span>의 의미는 다른 조건이 동일할 때, 평균하회 그룹의 임금이 평균 그룹에 비해 평균적으로 12.4% 더 낮다는 것이다.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="05_%ED%86%B5%EA%B3%84%EC%A0%81_%ED%95%99%EC%8A%B5.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">5장 통계적 학습</p>
      </div>
    </a>
    <a class="right-next"
       href="07_%EB%A1%9C%EC%A7%80%EC%8A%A4%ED%8B%B1_%ED%9A%8C%EA%B7%80%EB%A5%BC_%EC%9D%B4%EC%9A%A9%ED%95%9C_%EB%B6%84%EB%A5%98.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">7장 로지스틱 회귀를 이용한 분류</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">6.1 단순 선형 회귀</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ols">OLS 추정</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">추정 예: 광고 데이터</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">산점도 및 추정 회귀선</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">OLS 추정</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chatgpt-q-a">ChatGPT Q&amp;A</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">시뮬레이션: 추정 오차</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">표준오차</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">신뢰구간</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">가설검정</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t">t-통계량</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#p">p값</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">통계적 유의성</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">추정 결과 해석</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">모델의 정확성 평가</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">6.2 다중 선형 회귀</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">추정</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#f">F-통계량</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">모델 적합성</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">예측: 신뢰구간</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">6.3 회귀 모델 기타 고려 사항</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">정성적 예측변수</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">상호작용 항의 도입</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">다항식 회귀</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">6.4 선형 회귀 예제</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">보스턴 주택가격 데이터</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#level-vs-log">Level 변수 vs Log 변수 계수의 해석</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">카시트 판매 데이터</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">자동차 연비 데이터</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">ChatGPT Q&amp;A</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">부록: 선형 회귀 로그변수 계수 해석</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">로그변화율</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">로그변수와 한계효과</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id29">로그변수 해석 사례</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By 최필선 민인식
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>